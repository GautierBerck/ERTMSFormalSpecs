<NameSpace
 Name="EURORADIO"
 Guid="e1153af3-3878-4752-bfdb-9a6c11411de4"
>
<NameSpaces>
<NameSpaceRef
 Name="PositionReport"
 Guid="c9623ca4-7f96-47f9-9040-bcb29cb92c3d"
>
</NameSpaceRef><NameSpaceRef
 Name="TrainData"
 Guid="3e0fac33-af2e-49fb-87bd-7ac9bade11fe"
>
</NameSpaceRef></NameSpaces>
<Enumerations>
<Enum
 Default="SafeRadioConnectionStatusEnum.NoConnection"
 Implemented="TRUE"
 Name="SafeRadioConnectionStatusEnum"
 Guid="fe039c94-e8dc-416a-b815-f5ad8300c526"
>
<ReqRef
 Id="747bae2e-7720-4f04-ac58-bf2f7feb9e50"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9a75773a-005e-4c35-993c-02bb41df811e"
>
</ReqRef><Comment>Possible safe connection statuses.</Comment>
<Values>
<EnumValue
 Value="0"
 Name="NoConnection"
 Guid="56356f1b-8662-4507-a0d9-ec8a7d4cd272"
>
</EnumValue><EnumValue
 Value="1"
 Name="ConnectionLostOrSetUpFailed"
 Guid="6e15a44f-7a64-4aef-8094-c6cd3222235a"
>
</EnumValue><EnumValue
 Value="2"
 Name="ConnectionUp"
 Guid="865de485-ea5e-45e3-9dbe-9d63433a1a2e"
>
</EnumValue></Values>
</Enum><Enum
 Default="ContactActionEnum.Establish"
 Implemented="TRUE"
 Name="ContactActionEnum"
 Guid="ea5b0cd8-a7cc-4aca-9390-c8842517ff24"
>
<ReqRef
 Id="c2b39282-833e-4fd4-abd9-3a72c47f0782"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="22f89241-4057-4375-972a-172c9d3b6255"
>
</ReqRef><ReqRef
 Id="afd82aec-eda7-4ec0-8f16-8002a8687ab2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1079e0c0-c6d5-43ed-9d05-cecb7cb27883"
>
</ReqRef><Comment>Action to be performed while ordering to contact an RBC.</Comment>
<Values>
<EnumValue
 Value=""
 Name="Establish"
 Guid="34fd382e-e4ab-4f91-9e9e-cad2e2a7d21a"
>
</EnumValue><EnumValue
 Value=""
 Name="Terminate"
 Guid="efe01397-7c69-4d63-8eb6-7e646cca2191"
>
</EnumValue></Values>
</Enum><Enum
 Default="SystemVersionEnum.Version2_0"
 Implemented="TRUE"
 Name="SystemVersionEnum"
 Guid="e434ea8a-ec75-42f9-8347-85f8030caba3"
>
<ReqRef
 Id="790cf49e-a85c-4110-b567-fc5d57052339"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a3662f1a-59bd-4477-b564-a2296f7d6fb2"
>
</ReqRef><ReqRef
 Id="25af834a-3a24-459b-b5c8-97b85eddb2e8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2cbb484c-d4dd-4b8a-92b8-7c9588c87ca0"
>
</ReqRef><Comment>Gives the possible system versions for Euroradio communication.</Comment>
<Values>
<EnumValue
 Value="0"
 Name="Version1_0"
 Guid="57240a8e-82c1-4bc2-85a2-0db7d7eca3b9"
>
</EnumValue><EnumValue
 Value="1"
 Name="Version1_1"
 Guid="0dc39e5e-a3df-4e7b-b900-0faa0a026b92"
>
</EnumValue><EnumValue
 Value="2"
 Name="Version2_0"
 Guid="27af6815-c66e-44a0-8232-36c46b5f46f1"
>
</EnumValue></Values>
</Enum><Enum
 Default="ContactOptionEnum.ContactLastKnownRBC"
 Implemented="TRUE"
 Name="ContactOptionEnum"
 Guid="7bab1523-0861-44c9-ad3b-364cd97fcc04"
>
<ReqRef
 Id="369d7ae0-50db-411b-9941-bbe30e354733"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a0c7f339-6f2d-4c73-95b4-8cefbd1020ac"
>
</ReqRef><ReqRef
 Id="40859515-77c4-46aa-96a5-12453cd171a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7dc8e3c5-7a8b-446a-8538-363110bacba6"
>
</ReqRef><ReqRef
 Id="cebfc056-7b96-49d7-a6ff-1fdf0076bb9e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1e3e0613-ae98-44ff-a1b3-6f6d8fff01d4"
>
</ReqRef><Comment>Indicates how the RBC has to be contacted.</Comment>
<Values>
<EnumValue
 Value="0"
 Name="ContactLastKnownRBC"
 Guid="b8d94300-4144-4b52-9852-f37c28d2ee88"
>
</EnumValue><EnumValue
 Value="1"
 Name="UseOnBoardStoredShortNumber"
 Guid="69a92fdd-ed20-43d6-b2f5-6dd666092907"
>
</EnumValue><EnumValue
 Value="2"
 Name="RBCIdAndPhoneNumber"
 Guid="e2610b4d-3509-49f9-bb90-82315bcfe068"
>
</EnumValue></Values>
</Enum></Enumerations>
<Structures>
<Structure
 Implemented="TRUE"
 Name="RBCStruct"
 Guid="a486085f-3201-4bf5-8db8-cf3027c03815"
>
<ReqRef
 Id="becb430f-a4f2-4817-ad08-3672ed05f855"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cb738b09-f0d3-4a4e-8c82-014ee43482cc"
>
</ReqRef><Comment>Represents one instance of communication with RBC.</Comment>
<Rules>
<Rule
 Priority="CleanUp"
 Implemented="TRUE"
 Name="Clear input message"
 Guid="46319b75-1481-4c0f-aa43-2ddac6249e60"
>
<Comment>Ah the end of the cycle, the message has to be erazed (otherwise at the beginning of the following cycle the system will consider that this message is received again).</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Clear input message"
 Guid="48c4a0a3-7c51-4de9-86b1-e4e9433a8cde"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="0271d2ba-8432-4ab8-9751-21368dd80660"
>MessageIn &lt;- EMPTY</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
<Procedures>
<Procedure
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SendPositionReport"
 Guid="d551c0f2-3853-4033-86fa-bb55a4747107"
>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="1e838a0b-1365-4864-a698-9b6294d2c77d"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="1326e3c1-f9f4-4e39-a552-d0f91ba0ed9e"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="d36b5e14-701a-47f8-a07f-2c20c9a57a79"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Send position report"
 Guid="82ce2511-2a70-4ca7-8582-7a7414817805"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Send position report"
 Guid="b7be9954-2e9c-4bfa-b6d1-db8342f482c8"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="79dbebec-3f39-4331-b8b2-edabf9c5149b"
>MessageOut.TRAIN_POSITION_REPORT &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.TRAIN_POSITION_REPORT.Message
{
    L_MESSAGE =&gt; EMPTY,
    NID_ENGINE =&gt; EMPTY,
    NID_MESSAGE =&gt; EMPTY,
    POSITION_REPORT =&gt; PositionReport.CreatePositionReport(),
    Sequence1 =&gt; EMPTY,
    T_TRAIN =&gt; EMPTY
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendSOMPositionReport"
 Guid="e3220a82-2afc-4b5c-a090-53f9bb36659b"
>
<ReqRef
 Id="aa43ddb6-13a5-4b3e-bbcc-bf985bea4175"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="767f0bfd-f651-4416-b879-f414c2f79cea"
>
</ReqRef><ReqRef
 Id="6375b0de-0293-4d16-abdf-cb5f39a35143"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e4dccb90-05ce-4571-9f3f-3523708d0a38"
>
</ReqRef><Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="a12be67a-f112-414a-af20-7873c6b0671e"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="3c9531c1-a642-4e1b-b3dd-dc4e7ab35d2c"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="ad87a631-5eb9-4189-b1f9-c830843481d2"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="Send SOM position report"
 Guid="e7b63b93-4c09-4afe-94e5-e1b9c3117f37"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Send SOM position report"
 Guid="4e90bb91-75ed-4086-9d9f-15cbf50dc8d1"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="ee5a0c21-596d-4adf-9f6e-f3f46a1437d7"
>MessageOut.SOM_POSITION_REPORT &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.SOM_POSITION_REPORT.Message
{
    L_MESSAGE =&gt; EMPTY,
    NID_ENGINE =&gt; EMPTY,
    NID_MESSAGE =&gt; EMPTY,
    Q_STATUS =&gt; PositionReport.FillQStatus(),
    POSITION_REPORT =&gt; PositionReport.CreatePositionReport(),
    Sequence1 =&gt; EMPTY,
    T_TRAIN =&gt; EMPTY
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Name="InitializeOutMessage"
 Guid="c3a62f8f-4ddb-4ad9-b370-6cb6b66ac72b"
>
<Comment>This procedure has to be called before filling the out message with some information.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize out message"
 Guid="6d4d6846-0184-40cc-87a6-19c04a568c69"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Initialize out message"
 Guid="383c3a6c-4b8b-411f-b5a0-6dacf0dfa9bd"
>
<PreConditions>
<PreCondition
 Guid="96e96db5-efb2-4460-8166-cd2593b2ee48"
>MessageOut == EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2d00e9a8-4356-42a6-a9b3-cdf669db2f2b"
>MessageOut &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.Message
{
    VALIDATED_TRAIN_DATA =&gt; EMPTY,
    TRAIN_POSITION_REPORT =&gt; EMPTY,
    REQUEST_FOR_SHUNTING =&gt; EMPTY,
    MA_REQUEST =&gt; EMPTY,
    TRAIN_POSITION_REPORT =&gt; EMPTY,
    REQUEST_TO_SHORTEN_MA_IS_GRANTED =&gt; EMPTY,
    REQUEST_TO_SHORTEN_MA_IS_REJECTED =&gt; EMPTY,
    ACKNOWLEDGEMENT =&gt; EMPTY,
    ACKNOWLEDGEMENT_OF_EMERGENCY_STOP =&gt; EMPTY,
    TRACK_AHEAD_FREE_GRANTED =&gt; EMPTY,
    END_OF_MISSION =&gt; EMPTY,
    RADIO_INFILL_REQUEST =&gt; EMPTY,
    NO_COMPATIBLE_VERSION_SUPPORTED =&gt; EMPTY,
    INITIATION_OF_A_COMMUNICATION_SESSION =&gt; EMPTY,
    TERMINATION_OF_A_COMMUNICATION_SESSION =&gt; EMPTY,
    SOM_POSITION_REPORT =&gt; EMPTY,
    TEXT_MESSAGE_ACKNOWLEDGED_BY_DRIVER =&gt; EMPTY,
    SESSION_ESTABLISHED =&gt; EMPTY
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendTrainData"
 Guid="5e8585ff-5096-4df7-a74d-9272db3f84cf"
>
<ReqRef
 Id="8b735562-2ede-429c-940c-7f53b0f6f675"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c76f8877-efbd-4800-b4d0-0be9f93c28fd"
>
</ReqRef><ReqRef
 Id="0aa692d6-e57e-48a1-929d-b3f3a51951bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d24f2133-00f7-4fd4-9180-c9bafc9b71cf"
>
</ReqRef><Comment></Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="511ff74f-c4b6-4b78-810c-99f0123510ee"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="2687b67a-4497-4efc-b70d-2d91183ff1bd"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="5e0b679f-e1cd-4f2e-a08e-c29838eb1d21"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="Send train data"
 Guid="872d1f42-9012-45ab-851c-1d031e37d13a"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Send train data"
 Guid="02987fbb-6adb-49ac-926b-9a702a9f3ceb"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="f26165a7-1b31-4afe-b6c9-ea1f49fa06de"
>MessageOut.VALIDATED_TRAIN_DATA &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.VALIDATED_TRAIN_DATA.Message
{
    L_MESSAGE =&gt; 0,
    NID_ENGINE =&gt; 0,
    NID_MESSAGE =&gt; 129,
    T_TRAIN =&gt; 0,
    VALIDATED_TRAIN_DATA =&gt; TrainData.CreateTrainData()
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendEoMReport"
 Guid="ab89aa1a-870b-435e-9232-e0bed3a33834"
>
<ReqRef
 Id="3f735818-2dc8-4e4a-a842-9112c3e053a9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="21ee6751-35c3-4438-84e8-e4d7b17d623b"
>
</ReqRef><ReqRef
 Id="7b63a22c-a47e-4e98-87a7-bb6800dbb38e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e46bb61e-928d-4a62-8c22-bff1af3712ac"
>
</ReqRef><Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="3eabc145-1193-4620-be32-ebc6cf35c2b4"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="144933fc-e9f1-4489-911e-e6bf16b8ad3b"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="159f8be9-e901-46cd-b31a-91728b854d33"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send EoM report"
 Guid="5a3dfb27-b6e9-43df-b30b-358a19f04fb9"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send EoM report"
 Guid="548bd947-dca9-48ba-910e-f261128b06b6"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="5d5990b8-a350-4843-9667-b01f3a4ae06c"
>MessageOut.END_OF_MISSION &lt;-Messages.MESSAGE.TRAIN_TO_TRACK.END_OF_MISSION.Message{
    NID_MESSAGE =&gt; 0,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; 0,
    NID_ENGINE =&gt; 0,
    POSITION_REPORT =&gt; EURORADIO.PositionReport.CreatePositionReport()
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendRequestForShunting"
 Guid="bbf768a6-9eec-467b-b2ef-6470b3f72595"
>
<ReqRef
 Id="457bd04c-8b77-4ecc-b5ec-c4dbce5c1e53"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="376abddb-f246-4e20-8cd6-b3fb29cb373c"
>
</ReqRef><Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="aae94d1a-4576-49d7-ab43-e61a40efe9e9"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="31f1450c-9cfd-4568-8768-521f7b2f72e5"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="22e1fb48-7194-41fa-9413-884aed465214"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Send Request for Shunting"
 Guid="592cdc3a-a9ac-4116-8e09-d56c9311fe9e"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send Request for Shunting"
 Guid="f43c3579-ea00-4730-b1f4-763eea38dcc9"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="7297c0d3-1229-4d0e-9a96-f81af5183fa9"
>MessageOut.REQUEST_FOR_SHUNTING &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.REQUEST_FOR_SHUNTING.Message
{
    NID_MESSAGE =&gt; 130,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; MessageTypes.Time ( Kernel.CurrentTime ),
    NID_ENGINE =&gt; Kernel.NidEngine,
    POSITION_REPORT =&gt; PositionReport.CreatePositionReport()
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendMARequest"
 Guid="605c5787-3cea-40e3-9541-b6fee56354ff"
>
<ReqRef
 Id="b74d1689-f942-4e2a-abdb-aa241f4f117f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="21b60f86-6bac-4cab-822c-a49daf822344"
>
</ReqRef><Parameters>
<Parameter
 Type="Messages.Q_MARQSTREASON"
 Name="aReason"
 Guid="5c0da812-a270-4cf0-b8e8-c58eb2c798db"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message_1"
 Guid="d3b68b75-987a-41d6-99f1-fb0772635b9e"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="4e0423b2-ff99-457f-bc39-7ee3fbd568f4"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="bd0bff4f-a385-4604-9275-9ca2e8029bb5"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="Send MA request"
 Guid="32efbbf1-f2da-49ca-8d3a-de8db9f9a608"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 NeedsRequirement="FALSE"
 Name="Send MA request"
 Guid="5453c885-e136-49b5-8072-69a3f4e899ac"
>
<Comment></Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="f105e56b-cf2d-4016-b30e-0ea135442f31"
>MessageOut.MA_REQUEST &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.MA_REQUEST.Message
{
    NID_MESSAGE =&gt; 132,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; MessageTypes.Time ( Kernel.CurrentTime ),
    NID_ENGINE =&gt; Kernel.NidEngine,
    Q_MARQSTREASON =&gt; aReason,
    POSITION_REPORT =&gt; PositionReport.CreatePositionReport()
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendAcknowledgementOfEmergencyStop"
 Guid="e87a9d80-111c-45f9-832c-e6cafcf1c042"
>
<ReqRef
 Id="4f290d49-e10d-41ae-a385-d9a756df04d3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="90a03ff5-462d-42bf-9ca2-65cd7a0f9ed0"
>
</ReqRef><Comment>Fills the out message with an acknowledgement of emergency stop message</Comment>
<Parameters>
<Parameter
 Type="Messages.MESSAGE.TRACK_TO_TRAIN.Message"
 Name="aMessage"
 Guid="7d4addf6-2d0c-478d-8a18-29d13281c06a"
>
</Parameter><Parameter
 Type="Messages.Q_EMERGENCYSTOP"
 Name="Qualifier"
 Guid="dbcb29cd-2b70-41c6-8e2a-39767e6620aa"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Name="Initialize message"
 Guid="ac03dd37-e4fd-465d-893a-8278a0376598"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Initialize message"
 Guid="61954d2d-de18-46d5-90c5-adb4d2c9e3ba"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="3977b5c4-e5bf-434c-932e-ed4d7cff72f5"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Name="Send emergency stop rejection"
 Guid="ad4c4384-48b9-4066-9332-2b21328ef512"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Send emergency stop rejection"
 Guid="cc544e71-6e86-430d-a549-2df2df9aa045"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="bf04e5dc-64f2-41c2-8382-b29798e0e305"
>MessageOut.ACKNOWLEDGEMENT_OF_EMERGENCY_STOP &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.ACKNOWLEDGEMENT_OF_EMERGENCY_STOP.Message
 {
    NID_MESSAGE =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.NID_MESSAGE,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; MessageTypes.UnResolveTime( time =&gt; Kernel.CurrentTime ),
    NID_ENGINE =&gt; Kernel.NidEngine,
    NID_EM =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.NID_EM,
    Q_EMERGENCYSTOP =&gt; Qualifier,
    POSITION_REPORT =&gt; PositionReport.CreatePositionReport()
 }</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendInitiationOfCommunicationSession"
 Guid="696d88ca-8c89-4d15-8686-73cc7ad795f2"
>
<ReqRef
 Id="1ead58b3-f05d-46bd-b3f8-bc0a16010cdd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4ea5e0d5-0e85-46a1-acd4-cda08bdc398a"
>
</ReqRef><Comment>Sends the initiation of communication session message.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="fbc287fc-61e7-449e-9d9f-a7e57f921c47"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="ca61f4f9-df8c-4f72-9d2d-f52350d0ef01"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="e922975d-2e7e-4fb8-ae7b-2051e81118c1"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send initiation of communication session"
 Guid="260229b4-4a1b-4342-b26a-aa625424c480"
>
<ReqRef
 Id="193e4ff3-c085-4881-89f4-4bba951aae20"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4d11307b-519f-45b9-85b0-e7d2884db4b6"
>
</ReqRef><ReqRef
 Id="f122a1cb-426c-4f27-b1b2-521eeb9d7655"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7f396564-f2af-4c95-9a90-f6386e4f3c99"
>
</ReqRef><ReqRef
 Id="974dafe8-70ad-409f-a13c-435c0f1b8be1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="14b27deb-8f05-4314-a01e-04f7a1441fcd"
>
</ReqRef><ReqRef
 Id="4faba43d-d002-4947-afce-02a4abef7460"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8d3e83cf-9906-4399-bc49-4407f109d051"
>
</ReqRef><ReqRef
 Id="58da8d69-4dcb-45db-96ea-d5985a650330"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="65a17490-e8c7-4eff-9f06-b2eedb78bdac"
>
</ReqRef><Comment>Sends the initiation of communication session message.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send initiation of communication session"
 Guid="cd51079a-9b65-4b6c-9bb5-5dc87ddac17a"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="5496a749-0788-45c7-917c-9edb136dfa0c"
>MessageOut.INITIATION_OF_A_COMMUNICATION_SESSION &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.INITIATION_OF_A_COMMUNICATION_SESSION.Message
{
    NID_MESSAGE =&gt; 155,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; MessageTypes.Time ( Kernel.CurrentTime ),
    NID_ENGINE =&gt; Kernel.NidEngine
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="SendTerminationOfCommunicationSession"
 Guid="be6b5b3e-b56c-4f31-974d-943f13071346"
>
<ReqRef
 Id="bc41e5e5-6fff-4b96-a901-9bc45f108b16"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="693180ad-3698-4e96-a0da-37ed0402c784"
>
</ReqRef><Comment>Sends the termination of communication session message.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Initialize message"
 Guid="abadcaa6-e65d-4b7d-bbcb-b0cfdae0dd85"
>
<Comment>If the message is EMPTY, it has to be initialized</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Initialize message"
 Guid="8334b1bb-9709-4418-a6e3-507dd7a6b908"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="9025ba4e-91d5-4f92-8289-74df36138ac0"
>InitializeOutMessage()</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Send termination of communication session"
 Guid="e7da29c3-449f-4dab-b416-9f5dd4524bc5"
>
<ReqRef
 Id="a74ee6b4-a0ba-40bb-b83f-fd66efae3fb1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="58762fff-a603-4708-9ec1-d30a91abc678"
>
</ReqRef><ReqRef
 Id="8c9ce563-d6d0-4490-a402-5a4bcf54598c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e354eeae-9a16-49a0-96f9-dec793c48066"
>
</ReqRef><ReqRef
 Id="a4fe513a-ba78-4d81-a472-2d562542fef9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d9c377d0-7f52-4cd8-9f11-7257ca89df4f"
>
</ReqRef><ReqRef
 Id="4d45f289-023e-4ed4-a8b2-f23bc5f23bbf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1576da1c-6e2c-41b6-84fd-ec3dd7110c26"
>
</ReqRef><ReqRef
 Id="78ebe076-c514-44ee-869e-00b94b6a4377"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="aaf76c16-6214-4a5c-8558-d2afc429ec91"
>
</ReqRef><SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send termination of communication session"
 Guid="46369c42-16c2-4020-9add-b41e20b7948f"
>
<Comment>Sends the termination of cummnication session message.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="1069c60a-1628-4196-9f66-c7cb41b5fed5"
>MessageOut.TERMINATION_OF_A_COMMUNICATION_SESSION &lt;- Messages.MESSAGE.TRAIN_TO_TRACK.TERMINATION_OF_A_COMMUNICATION_SESSION.Message
{
    NID_MESSAGE =&gt; 156,
    L_MESSAGE =&gt; 0,
    T_TRAIN =&gt; MessageTypes.Time ( Kernel.CurrentTime ),
    NID_ENGINE =&gt; Kernel.NidEngine
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ReinitializeCommunicationInformation"
 Guid="30fa714a-600a-440b-9bf9-ce5c3055c1ad"
>
<Comment>When a communicatino session is terminated, all the information is reset to default values.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Reinitialize communication information"
 Guid="6da01d9a-0a55-4ae4-be3e-0eb9708c6062"
>
<Comment>When a communicatino session is terminated, all the information is reset to default values.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Reinitialize communication information"
 Guid="1a9ebfb8-f176-4c4b-85c9-9b8a8acf5b77"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="2c770b25-75ef-4584-9ad0-ad6650c0cd3d"
>SessionManagementData.AcknowledgementOfTerminationReceived &lt;- False</Action><Action
 Guid="f86651e7-1ebb-49de-8053-907c88f5741d"
>NumberOfSentRequests &lt;- 0</Action><Action
 Guid="3d5afa42-b712-4474-af54-81ae258173b2"
>SessionManagementData.SystemVersion.DataState &lt;- DataState.Unknown</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<StructureElement
 TypeName="Messages.MESSAGE.TRACK_TO_TRAIN.Message"
 Default="EMPTY"
 Mode="InOut"
 Implemented="TRUE"
 Name="MessageIn"
 Guid="cdeef650-7114-4f12-8bfd-c8962d8ff0a2"
>
<Comment>Represents the message received from the current RBC. If no message is received, the structure is EMPTY.</Comment>
</StructureElement><StructureElement
 TypeName="Messages.MESSAGE.TRAIN_TO_TRACK.Message"
 Default="EMPTY"
 Mode="InOut"
 Implemented="TRUE"
 Name="MessageOut"
 Guid="19cbc992-30ef-4db9-a8d2-4816992c1126"
>
<Comment>Represents the message to send to the current RBC. If no message has to be sent, the structure is EMPTY.</Comment>
</StructureElement><StructureElement
 TypeName="RBCContactStruct"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="ContactData"
 Guid="f619c693-9b6c-44b9-9e47-28d4270e994f"
>
<ReqRef
 Id="becb430f-a4f2-4817-ad08-3672ed05f855"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e994975e-ef44-45ee-9520-410116dd431c"
>
</ReqRef><Comment>Identifier of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="ConnectionStateSM"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="ConnectionState"
 Guid="9da35b1e-5a10-49fe-97e2-9344ea080d37"
>
<Comment>The state machine of the current connection.</Comment>
</StructureElement><StructureElement
 TypeName="SafeRadioConnectionStatusEnum"
 Default="SafeRadioConnectionStatusEnum.NoConnection"
 Mode="Internal"
 Implemented="TRUE"
 Name="SafeRadioConnectionStatus"
 Guid="ea1f0ade-0a84-48f2-a86e-2206d337446f"
>
<Comment>The safe radio connection status.</Comment>
</StructureElement><StructureElement
 TypeName="ContactOrderStruct"
 Default="EMPTY"
 Mode="Internal"
 Implemented="TRUE"
 Name="ContactRBCOrder"
 Guid="2007b98c-b3ea-412e-8bcf-fb463d719de4"
>
<Comment>Provides the order to contact the RBC, if any.</Comment>
</StructureElement><StructureElement
 TypeName="SessionManagementStruct"
 Default=""
 Mode="InOut"
 Implemented="TRUE"
 Name="SessionManagementData"
 Guid="1ca4ec93-c578-45ad-bbdb-e44c71c1f9aa"
>
<Comment>Data needed to establish a communication session.</Comment>
</StructureElement><StructureElement
 TypeName="Default.BaseTypes.Time"
 Default="0.0"
 Mode="Internal"
 Implemented="TRUE"
 Name="LastRequestTime"
 Guid="40e6ba54-d9c4-498d-88f2-2ffb1157f4aa"
>
<Comment>Indicates the last time when a request to the RBC was sent.</Comment>
</StructureElement><StructureElement
 TypeName="Integer"
 Default="0"
 Mode="Internal"
 Name="NumberOfSentRequests"
 Guid="03f193b2-8aea-4f04-b805-1de34a4398f8"
>
</StructureElement><StateMachines>
<StateMachine
 InitialState="Inactive"
 Name="ConnectionStateSM"
 Guid="d82fd57c-5e3b-49a3-9588-9ba0c3633131"
>
<Comment>Handles the different processes of the connection according to its current state.</Comment>
<States>
<State
 Implemented="TRUE"
 Name="Inactive"
 Guid="d33370b3-b877-475d-b1da-b15d3eaca819"
>
<Comment>No connection is established.</Comment>
<StateMachine
 InitialState=""
 Guid="691e3286-67ef-4b68-b4c9-5aa0ce8e8788"
>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="RBC contact order received"
 Guid="b1c9e783-f0f5-4d68-8816-a13e44c8b068"
>
<ReqRef
 Id="5b9e9eb3-ffa4-47c2-a6f5-9fa6efc58ffe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5458231e-1df4-425e-8e8b-9b993b243cc4"
>
</ReqRef><Comment>When an order to contact an RBC is received, the on-board requests the set-up of a safe radio connection with the trackside.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="RBC contact order received"
 Guid="16010e1f-582d-4673-a08f-e652d867206d"
>
<PreConditions>
<PreCondition
 Guid="d70d315d-97c4-418f-a89b-173190c448b2"
>ContactRBCOrder != EMPTY
  AND
ContactRBCOrder.ActionToPerform == ContactActionEnum.Establish</PreCondition></PreConditions>
<Actions>
<Action
 Guid="30ffcf61-752f-4621-bd06-aae49937b224"
>THIS &lt;- Connecting</Action><Action
 Guid="0435a548-28e2-45b2-b8f8-0711b2fc3498"
>SessionManagementData.RequestSent &lt;- True</Action><Action
 Guid="5c7318a3-3c2a-4a71-85c0-c1617d2d9134"
>SessionManagementData.Action &lt;- ContactActionEnum.Establish</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</StateMachine></State><State
 Name="Connecting"
 Guid="620d737c-d8e3-43c2-8cda-c9b1ca68371a"
>
<Comment>The connection is being established.</Comment>
<StateMachine
 InitialState=""
 Guid="939342a0-af0b-417c-af03-c79040f6200e"
>
<Rules>
<Rule
 Priority="Processing"
 Name="Handle the connection request"
 Guid="9a9bbb19-838a-48e9-aa60-b9dfeaf939af"
>
<Comment>As soon as the safe radio connection is set-up, the on-board sends the message Initiation of communication session.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Safe radio connection is set-up"
 Guid="dedc8409-7712-44a5-962a-944a3b26fe52"
>
<ReqRef
 Id="1ead58b3-f05d-46bd-b3f8-bc0a16010cdd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3e40cb31-2d77-4868-8f52-b6d63bd33ce7"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="28c2e922-3c7a-4a58-861a-33bc2615f866"
>SessionManagementData.ResponseReceived</PreCondition></PreConditions>
<Actions>
<Action
 Guid="623e6269-823f-4126-b491-ac074c895b43"
>SafeRadioConnectionStatus &lt;- SafeRadioConnectionStatusEnum.ConnectionUp</Action></Actions>
</RuleCondition><RuleCondition
 Name="Repeat the connection request"
 Guid="13984cfa-f744-469f-ab79-5063a2f58711"
>
<PreConditions>
<PreCondition
 Guid="efc41a15-575b-4c33-9d93-c2ad1a51a905"
>LastRequestTime + TimeBeforeMessageRepetition &lt; Kernel.CurrentTime</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Name="Repeat the connection request"
 Guid="c6cd2b9e-746c-48d2-b150-39954458d216"
>
<Comment>Handles the repetition of connection requests.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="The request is part of an on-going SoM"
 Guid="e49895de-cf43-46aa-b926-c7fbff4a44e0"
>
<Comment>If the request is part of an on-going SoM, it is repeated the number of times allowed by Appendix A3.1.</Comment>
<PreConditions>
<PreCondition
 Guid="870a013c-7c76-4333-a2b6-d4476047b946"
>Kernel.HandleModeChange in Kernel.HandleModeChangeSM.StartOfMission</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle request repetition in SoM"
 Guid="bdd73248-c577-4e8a-b9cd-d15a0842f3f0"
>
<Comment>If the request is part of an on-going SoM, it is repeated the number of times allowed by Appendix A3.1.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send new request"
 Guid="6ee281d8-5947-4fd2-b6ea-4a61e0f5d896"
>
<Comment>If the request has to be repeated and the maximum number of requests is not reached it, a new request is sent.</Comment>
<PreConditions>
<PreCondition
 Guid="5f21704f-fd79-4d25-ac8d-54f9ec46d7e7"
>NumberOfSentRequests &lt; NumberOfMessageRepetitions</PreCondition></PreConditions>
<Actions>
<Action
 Guid="6c9db820-9596-4dc3-b487-9fb6e343bc2b"
>LastRequestTime &lt;- Kernel.CurrentTime</Action><Action
 Guid="ba529648-8bde-4b6c-bab8-b53b04a493ea"
>SessionManagementData.RequestSent &lt;- True</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Maximum number of requests sent"
 Guid="301af69a-abcb-4f58-bb23-313539119ff7"
>
<Comment>If the request has to be repeated but the maximum number of requests is already reached, RBC declares that the setup has failed and goes to inactive state.</Comment>
<PreConditions>
<PreCondition
 Guid="4932a3e3-358f-4a69-b034-4dadf129cf89"
>NumberOfSentRequests== NumberOfMessageRepetitions</PreCondition></PreConditions>
<Actions>
<Action
 Guid="947cdfdd-e42c-4684-9dd1-65abb983fad5"
>THIS &lt;- Inactive</Action><Action
 Guid="c12bd255-c050-4efb-9c03-4e77c4f2b055"
>SafeRadioConnectionStatus &lt;- SafeRadioConnectionStatusEnum.ConnectionLostOrSetUpFailed</Action><Action
 Guid="d6469a14-111f-45b4-846e-e000f91ba652"
>NumberOfSentRequests &lt;- 0</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition><RuleCondition
 Name="The request is not a part of on-going SoM"
 Guid="ef0c34e4-8af2-49ed-8202-e5b73075c9dc"
>
<ReqRef
 Id="c2fdf450-8b2f-4ed0-a744-03d015cc0c69"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b55e54e0-51eb-4729-8895-578963ed886b"
>
</ReqRef><PreConditions>
</PreConditions>
<Actions>
</Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="System version received"
 Guid="504d3e3c-ba1c-4573-b0c5-e2c4369b494c"
>
<ReqRef
 Id="02f20f26-3445-49b9-95cf-a6948ab029b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="19083d61-5223-4c91-a7df-5a632a8820dc"
>
</ReqRef><Comment>When the system version is received, the communication session is considered as established.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="System version received"
 Guid="ffdd0e28-2dd6-49e6-aeb2-3d226bdb90dc"
>
<PreConditions>
<PreCondition
 Guid="fc7f4583-9abe-4721-9172-3d91c2dbab42"
>SessionManagementData.SystemVersion.DataState == DataState.Valid</PreCondition></PreConditions>
<Actions>
<Action
 Guid="b4f25d0d-6815-4c2d-ae03-b9c5f4fe9298"
>THIS &lt;- Connected</Action><Action
 Guid="978de328-21de-467f-af05-cca4f3410a75"
>SafeRadioConnectionStatus &lt;- SafeRadioConnectionStatusEnum.ConnectionUp</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Order to terminate the communication session is received"
 Guid="63704436-5af4-444f-a8e6-6349d2dee385"
>
<Comment>If an order to terminate the communication session is received in connecting state, the establishing of the communication session is aborted.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Order to terminate the communication session is received"
 Guid="a42b1225-8802-4fe3-9b3b-1148d9802095"
>
<PreConditions>
<PreCondition
 Guid="c94000a1-d7dc-4cd3-becf-159031484f3a"
>ContactRBCOrder != EMPTY
  AND
ContactRBCOrder.ActionToPerform == ContactActionEnum.Terminate</PreCondition></PreConditions>
<Actions>
<Action
 Guid="005fe0c4-14fe-4ed1-8754-5011041d3708"
>THIS &lt;- Inactive</Action><Action
 Guid="11826692-aff7-4c8a-8411-5a0c1d254194"
>SafeRadioConnectionStatus &lt;- SafeRadioConnectionStatusEnum.NoConnection</Action><Action
 Guid="4566df66-8602-481b-8e43-9d6cee572241"
>ReinitializeCommunicationInformation()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</StateMachine></State><State
 Name="Connected"
 Guid="9296f778-498c-4dfb-8eb9-bda176289afa"
>
<Comment>The connection is established.</Comment>
<StateMachine
 InitialState=""
 Guid="0b8f9771-1352-4442-9971-a125688da2ae"
>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Order to terminate the communication session is received"
 Guid="0f45f74c-edd2-48e5-af53-1c74c195841c"
>
<ReqRef
 Id="bc41e5e5-6fff-4b96-a901-9bc45f108b16"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="212177a5-3051-4788-a2b8-6951db3634a5"
>
</ReqRef><ReqRef
 Id="84374b3d-739e-4c5f-909d-4c138dedec38"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="cd739b37-15fd-4303-9f0b-a1dbca0c6555"
>
</ReqRef><ReqRef
 Id="e0a2f873-6bb3-4327-abdc-4444932d69aa"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="eb974e02-f7d4-476e-8b0f-f169719b35a4"
>
</ReqRef><ReqRef
 Id="dc7b33b5-d923-42f3-be12-580edb475353"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ed4afeb4-ab44-419a-ac37-d7bf139bcba3"
>
</ReqRef><Comment>When a connection to the RBC is established and a request to terminate the communication session is sent, on-board sends the Termination of communication session message to the RBC and goes to Terminating state.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Name="Order to terminate the communication session is received"
 Guid="63fe5c9c-8eee-4877-90ab-bc7187858c4a"
>
<PreConditions>
<PreCondition
 Guid="45eed858-9748-4822-b4df-ef101907fd7c"
>ContactRBCOrder != EMPTY
  AND
ContactRBCOrder.ActionToPerform == ContactActionEnum.Terminate</PreCondition></PreConditions>
<Actions>
<Action
 Guid="5ab8eb84-a856-41fe-81be-92cc80d83d99"
>SendTerminationOfCommunicationSession()</Action><Action
 Guid="37faeac1-ef2c-41c8-ab97-8497c4cfcec4"
>THIS &lt;- Terminating</Action><Action
 Guid="1a1a20cb-a8df-46b4-acc5-16faf2b26075"
>LastRequestTime &lt;- Kernel.CurrentTime</Action><Action
 Guid="ef59530a-188c-48af-86c4-658498732214"
>NumberOfSentRequests &lt;- 0</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</StateMachine></State><State
 Name="Terminating"
 Guid="852724a0-2e07-4fc6-ba9d-25a46e4032a2"
>
<Comment>The connection is being terminated.</Comment>
<StateMachine
 InitialState=""
 Guid="dfd5369b-7468-4e57-b4c3-591d53607134"
>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle termination of the communication session"
 Guid="0b222548-b9a6-47d8-8a8c-8f261e6eb180"
>
<ReqRef
 Id="e094e23a-bd94-4440-8632-705782494f35"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="63123e27-5ac2-4644-8140-a5dd7442b99b"
>
</ReqRef><ReqRef
 Id="84374b3d-739e-4c5f-909d-4c138dedec38"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="59066bae-3e0b-4004-b5b2-be0402ed6023"
>
</ReqRef><Comment>If the acknowledgement of termination of the communication session is received, the session is considered as terminated and the process goes to Inactive state.

The information related to the current communication session is reinitialized.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Acknowledgement of termination of the communication session received"
 Guid="cc43a2d6-cf19-4c54-b780-87cc183105b5"
>
<PreConditions>
<PreCondition
 Guid="7f763801-e844-4ab3-8b0f-19790f512002"
>SessionManagementData.AcknowledgementOfTerminationReceived</PreCondition></PreConditions>
<Actions>
<Action
 Guid="cf4d6f18-e067-47ef-af99-8b3cdfe23667"
>THIS &lt;- Inactive</Action><Action
 Guid="8a08daf0-bedb-4977-a7e3-57845212e89b"
>ReinitializeCommunicationInformation()</Action><Action
 Guid="b2911cf2-e495-44ac-9990-c74a924f43a4"
>SessionManagementData.Action &lt;- ContactActionEnum.Terminate</Action><Action
 Guid="647ebe75-16e6-45fe-b548-651236617b73"
>SessionManagementData.RequestSent &lt;- True</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Repeat Termination of Communication Session message"
 Guid="87eca200-42d6-473a-8745-c19edc24eb83"
>
<PreConditions>
<PreCondition
 Guid="ebbbdd28-776f-4041-a17e-a784bdf6b436"
>LastRequestTime + TimeBeforeMessageRepetition &lt; Kernel.CurrentTime</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Repeat Termination of Communication Session message"
 Guid="74dff78e-a344-4a11-93c2-e698be2bc6fc"
>
<Comment>If no acknowledgement is received from the trackside, the on-board will repeat the Termination of Communication Session request.

Aftter a defined number of repetitions, if no acknowledgement is received from the trackside, the on-board considers the communication session as terminated.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Send new request"
 Guid="b3a909c4-5069-4860-8ce2-fd7cf6766e91"
>
<ReqRef
 Id="dc7b33b5-d923-42f3-be12-580edb475353"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="13e5d684-7a46-4916-9f4f-f63351acf2f0"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="d39bee63-0912-4fd7-8aa4-ceebf64406ef"
>NumberOfSentRequests &lt; NumberOfMessageRepetitions</PreCondition></PreConditions>
<Actions>
<Action
 Guid="8c94cd62-33d6-44a8-a726-b48c5e0f1d88"
>LastRequestTime &lt;- Kernel.CurrentTime</Action><Action
 Guid="23e6bfe2-b29f-4f51-a757-32c619717618"
>SendTerminationOfCommunicationSession()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Maximum number of requests sent"
 Guid="a41352cb-2ce8-49ed-84f9-0c2762b9f3e3"
>
<ReqRef
 Id="e0a2f873-6bb3-4327-abdc-4444932d69aa"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="23154fa5-ffb1-4040-b127-be2ffd711f99"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="5616a12c-8a52-4abf-8880-c4a24d75d94e"
>NumberOfSentRequests== NumberOfMessageRepetitions</PreCondition></PreConditions>
<Actions>
<Action
 Guid="ca565153-dca3-42f4-a94e-b62cfede617a"
>THIS &lt;- Inactive</Action><Action
 Guid="eb00bc7c-9434-485a-a33c-1463adc14358"
>SafeRadioConnectionStatus &lt;- SafeRadioConnectionStatusEnum.NoConnection</Action><Action
 Guid="f3f8fa5b-bb54-459b-836d-86a309a18c16"
>ReinitializeCommunicationInformation()</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule></Rules>
</StateMachine></State></States>
</StateMachine></StateMachines>
</Structure><Structure
 Implemented="TRUE"
 Name="ContactOrderStruct"
 Guid="0b20f5b7-2179-44b2-b8c4-19c69efa393a"
>
<ReqRef
 Id="951fc6d8-739b-4bd4-9361-5686840e8b5a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="aad52615-8995-411d-beac-095d25210560"
>
</ReqRef><ReqRef
 Id="711a8f6b-f758-4405-bb80-f9b331940c39"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="53323bec-6f3a-4084-adce-0d087292a1ba"
>
</ReqRef><ReqRef
 Id="64296fc8-fe88-499d-b63e-d570a4a39744"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d37b22c1-9b7f-4129-a033-3e1fab068fc5"
>
</ReqRef><Comment>Contains information needed to contact an RBC or an RIU.</Comment>
<StructureElement
 TypeName="RBCIdStruct"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Id"
 Guid="090d6f31-3d17-41d8-a297-773c0dad4df8"
>
<ReqRef
 Id="cfa25d7e-ba55-4b80-ba0e-931979188cd9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7e3ada7b-82db-4b53-aa7f-5bf0c7825f02"
>
</ReqRef><ReqRef
 Id="bf375eb5-37d4-48bc-9e97-ed34696dd18d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9a7c2039-8f5c-4b40-863e-1a727356ea4f"
>
</ReqRef><ReqRef
 Id="27b4bef1-4915-47e2-b193-48f7f3daae5c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="278d8f6e-9124-4385-8139-53c90b4599b7"
>
</ReqRef><Comment>The identity of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="String"
 Default="&apos;&apos;"
 Mode="Internal"
 Implemented="TRUE"
 Name="PhoneNumber"
 Guid="8403992a-5c33-472a-915b-6e9e82f06133"
>
<ReqRef
 Id="e7d678f2-4b9e-4960-818a-8773557c1742"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4093722b-d3f7-4c8e-9f44-3881216778b4"
>
</ReqRef><ReqRef
 Id="1edceb91-f111-4748-af9c-6d142efbb335"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2e03d81a-fdd4-4dc8-911c-9b562d20b4e6"
>
</ReqRef><ReqRef
 Id="95aa03b6-4c5a-49a1-ac97-d11d63ebc609"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="944bd39d-7437-4b63-b998-e7cac319656a"
>
</ReqRef><Comment>Phone number of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="ContactActionEnum"
 Default="ContactActionEnum.Establish"
 Mode="Internal"
 Implemented="TRUE"
 Name="ActionToPerform"
 Guid="86ca7945-4cbf-4528-960c-a9062aa3621e"
>
<ReqRef
 Id="c2b39282-833e-4fd4-abd9-3a72c47f0782"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2fb816a0-8a56-460d-a842-d80a533ad336"
>
</ReqRef><ReqRef
 Id="afd82aec-eda7-4ec0-8f16-8002a8687ab2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9540ded4-9a23-491b-95f0-5fd9dc61c7c2"
>
</ReqRef><Comment>The action to be performed.</Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default="Boolean.False"
 Mode="Internal"
 Implemented="TRUE"
 Name="AppliesToSleepingUnits"
 Guid="4701d82d-24e3-4223-926c-223b4125b649"
>
<ReqRef
 Id="53c901d2-749c-41ce-be89-218897ceff07"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="589b9aa8-6e18-48a6-aab9-eedfa3941ab0"
>
</ReqRef><ReqRef
 Id="bae735db-1bcf-40d2-b035-f39a5663407f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d966b111-ad3c-4937-9f9c-18b07bd04154"
>
</ReqRef><Comment>Indicates whether the order applies also to Sleeping units.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="RIUStruct"
 Guid="b15198c3-238e-44cf-bd78-8b40d48ea78f"
>
<ReqRef
 Id="64296fc8-fe88-499d-b63e-d570a4a39744"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="17bba8ad-3761-4af8-8daf-f79e39a3b371"
>
</ReqRef><Comment>Represents one instance of the communication with RIU.</Comment>
<StructureElement
 TypeName="ContactOrderStruct"
 Default="EMPTY"
 Mode="Internal"
 Implemented="TRUE"
 Name="ContactRIUOrder"
 Guid="c3e64fd7-0dd2-4223-92a2-d1329120f4ae"
>
<Comment>Provides the order to contact the RIU, if any.</Comment>
</StructureElement><StructureElement
 TypeName="String"
 Default="&apos;&apos;"
 Mode="Internal"
 Implemented="TRUE"
 Name="Id"
 Guid="a69353b2-8731-4f5b-aeb0-cb1b2109d29b"
>
<Comment>Identifier of the RIU.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="SessionManagementStruct"
 Guid="395169e1-4c72-48ca-950b-fa0d473758a1"
>
<Comment>Data used to establish a session.</Comment>
<Rules>
<Rule
 Priority="Verification"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="CleanUp"
 Guid="205e01b9-eb50-4780-9ba5-1d03cd0a56e7"
>
<Comment>Resets the request to false.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="CleanUp"
 Guid="6fdc24b9-9135-4544-8be5-2872afecf193"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="554740df-b62d-4d21-9e26-a8e2554409c8"
>RequestSent &lt;- False</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
<StructureElement
 TypeName="Boolean"
 Default="Boolean.False"
 Mode="Internal"
 Implemented="TRUE"
 Name="RequestSent"
 Guid="3da0a1c7-ca89-43ab-9597-09b7adf15b15"
>
<Comment>Set to True when a request to establish a safe radio connection has to be sent.</Comment>
</StructureElement><StructureElement
 TypeName="SystemVersionStruct"
 Default=""
 Mode="Incoming"
 Implemented="TRUE"
 Name="SystemVersion"
 Guid="abb42052-649b-4e21-b7c9-461a8f11576a"
>
<Comment>The system version of the trackside.</Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default="Boolean.False"
 Mode="Incoming"
 Implemented="TRUE"
 Name="ResponseReceived"
 Guid="c17b46b9-59d6-4f7e-8701-92890b16dc3f"
>
<Comment>Is set to True when the safe radio connection is established.</Comment>
</StructureElement><StructureElement
 TypeName="ContactActionEnum"
 Default="ContactActionEnum.Establish"
 Mode="Outgoing"
 Implemented="TRUE"
 Name="Action"
 Guid="ccb009cb-f504-4789-b154-dcf7169abe80"
>
<Comment>Indicates if the safe radio connection has to be established or released.</Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default="Boolean.False"
 Mode="Internal"
 Implemented="TRUE"
 Name="AcknowledgementOfTerminationReceived"
 Guid="80da740b-776c-4027-8852-3ce69d47eaf8"
>
<Comment>Is set to true when, during the termination of the communication session procedure, on-board receives the acknowledgement of termination from the RBC.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="RBCIdStruct"
 Guid="06bc7e20-822b-4896-a367-bc92333c4911"
>
<Comment>Identity of an RBC.</Comment>
<StructureElement
 TypeName="Messages.NID_C"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Country"
 Guid="05cede5e-c482-41df-9072-e4113ad144b9"
>
<Comment>Country of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="Messages.NID_RBC"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Id"
 Guid="aa91517d-2240-40b4-bfd9-8878fcc96be9"
>
<Comment>Identifier of the RBC.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="RBCContactStruct"
 Guid="34a7c15c-662b-4a6d-a149-5587a333e7cf"
>
<Comment>Contains information about the last known RBC.</Comment>
<StructureElement
 TypeName="RBCIdStruct"
 Default=""
 Mode="Internal"
 Implemented="TRUE"
 Name="Id"
 Guid="99ae12d2-bc9c-4170-a5ac-5ec02a642457"
>
<Comment>Identifier of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="String"
 Default="&apos;&apos;"
 Mode="Internal"
 Implemented="TRUE"
 Name="PhoneNumber"
 Guid="3367d1e9-5512-45ec-9356-57305e0372d5"
>
<Comment>Phone number of the RBC.</Comment>
</StructureElement><StructureElement
 TypeName="Default.DataState"
 Default="DataState.Invalid"
 Mode="Internal"
 Implemented="TRUE"
 Name="DataState"
 Guid="45de8d20-e175-4ce8-b6a0-8f05a6e55a99"
>
<Comment>Data state of the contact information.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="MobileTerminalStruct"
 Guid="d55c89a9-b712-45c6-a15c-1829f68822b8"
>
<ReqRef
 Id="865bbdd6-2010-4869-ab3e-bc538ce5fe4b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9d479d3a-f46e-441c-92ba-733d4471c6c5"
>
</ReqRef><Comment>Represents a mobile terminal.</Comment>
<StructureElement
 TypeName="String"
 Default="&apos;&apos;"
 Mode="Internal"
 Implemented="TRUE"
 Name="Id"
 Guid="94afdc00-ee3b-416f-a426-21fea264a34c"
>
<Comment>Identifier of the mobile terminal.</Comment>
</StructureElement><StructureElement
 TypeName="String"
 Default="&apos;&apos;"
 Mode="Internal"
 Implemented="TRUE"
 Name="NetworkId"
 Guid="a38f3a7d-5646-4e2c-9bf3-7329e3d2d746"
>
<Comment>Identifier of the network.</Comment>
</StructureElement><StructureElement
 TypeName="Boolean"
 Default="False"
 Mode="Internal"
 Implemented="TRUE"
 Name="IsRegistered"
 Guid="cfb23dd5-d65a-4a97-9854-23391f7523d4"
>
<Comment>Indicates if the mobile terminal is registered to the network.</Comment>
</StructureElement><StructureElement
 TypeName="RBCStruct"
 Default=""
 Mode="InOut"
 Implemented="TRUE"
 Name="RBCConnection"
 Guid="0af6403f-d522-46ef-ae39-17e5433e5c02"
>
<Comment>RBC connected on this terminal.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="AvailableNetworksStruct"
 Guid="e6849568-73f7-4b28-ae32-8b6bf0058e00"
>
<ReqRef
 Id="88987d99-35ff-4f33-894e-06060476dc7d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="81bc9c91-72b9-4123-8780-3da0231cb9ab"
>
</ReqRef><Comment>Allows to request the list of available and allowed networkds, based on a request to the Mobile Terminal(s).</Comment>
<StructureElement
 TypeName="Default.Request"
 Default="Default.Request.Disabled"
 Mode="Internal"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="RequestState"
 Guid="92cbb691-f862-4800-bcc1-b1c3201d2980"
>
<Comment>Allows to request the list of available and allowed networks.</Comment>
</StructureElement><StructureElement
 TypeName="EURORADIO.AvailableNetworksCol"
 Default="[]"
 Mode="Incoming"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Networks"
 Guid="0ed60605-c72c-4461-b890-b564097e7b37"
>
<Comment>Collection of available and allowed networks.</Comment>
</StructureElement></Structure><Structure
 Implemented="TRUE"
 Name="SystemVersionStruct"
 Guid="d57ddcfd-645d-4096-81d5-c12c41bd57bb"
>
<ReqRef
 Id="02f20f26-3445-49b9-95cf-a6948ab029b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="97b05239-dbfb-447a-953a-e1fbb1608040"
>
</ReqRef><Comment>Represents the system version received from the trackside.</Comment>
<StructureElement
 TypeName="SystemVersionEnum"
 Default="SystemVersionEnum.Version2_0"
 Mode="Internal"
 Implemented="TRUE"
 Name="Value"
 Guid="6b92d905-fc0e-4c7c-8f01-e8ea9c2663a8"
>
<Comment>The value of the system version.</Comment>
</StructureElement><StructureElement
 TypeName="Default.DataState"
 Default="Default.DataState.Unknown"
 Mode="Internal"
 Implemented="TRUE"
 Name="DataState"
 Guid="1d98ef8a-fbe4-4fe6-affb-c0d0d99bb986"
>
<Comment>The data state of the system version.</Comment>
</StructureElement></Structure></Structures>
<Collections>
<Collection
 TypeName="String"
 Default="[]"
 Implemented="TRUE"
 Name="AvailableNetworksCol"
 Guid="104401a1-8c78-4794-bf19-a0f04f17b077"
>
<ReqRef
 Id="88987d99-35ff-4f33-894e-06060476dc7d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8d18e7fe-9416-4292-a792-535d3df5e1e8"
>
</ReqRef><Comment>List of available and allowed networks.</Comment>
</Collection><Collection
 TypeName="SystemVersionEnum"
 MaxSize="3"
 Default="[]"
 Implemented="TRUE"
 Name="SystemVersionsCol"
 Guid="44ac3d41-0bd0-4d96-b3e0-236b9806487b"
>
<ReqRef
 Id="790cf49e-a85c-4110-b567-fc5d57052339"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="12a9527d-0bf4-441e-9f73-b172a6a10e83"
>
</ReqRef><ReqRef
 Id="25af834a-3a24-459b-b5c8-97b85eddb2e8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9de807bb-b66f-4d46-9fb0-4bded8376599"
>
</ReqRef><Comment>Collection system versions supported by on-board.</Comment>
</Collection></Collections>
<Functions>
<Function
 Type="Boolean"
 Implemented="TRUE"
 Name="HasActiveSession"
 Guid="7b48d082-5d7b-4d27-8757-6e110b3f9f7d"
>
<ReqRef
 Id="a2f8c5d0-9029-4c1f-b5bf-fee1dca550f7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d7366702-ff1d-4278-b4d6-ab392caaab2b"
>
</ReqRef><ReqRef
 Id="f4b1a027-643a-48c1-a840-1735e19ae661"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1585da45-384c-4bb1-8d20-801a20e325b3"
>
</ReqRef><ReqRef
 Id="58b99381-a184-4b10-8c25-d125705b5194"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="267a1a1e-4342-4fb3-8e7e-2665a3bbf0de"
>
</ReqRef><ReqRef
 Id="0a55611b-2936-44a8-89fb-8b7fa083a761"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89286c79-15e3-4d68-8bcc-c7bef8ead11d"
>
</ReqRef><Comment>Indicates if a communication session is established with an RBC.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="10904d1f-8fc9-4d89-a374-c156b560a9fe"
>
<Expression>Terminal1.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.ConnectionUp
  OR
Terminal2.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.ConnectionUp</Expression>
</Case></Cases>
</Function><Function
 Type="RBCStruct"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="CurrentRBCConnection"
 Guid="3f3bd225-5d45-4ad8-a3c3-4b15bd9d11e4"
>
<Comment>Provides the current RBC connection. If none of terminals is connected, RBC1 is provided.</Comment>
<Cases>
<Case
 Name="RBC1"
 Guid="721da144-3a02-4f84-8e10-a29715edbe77"
>
<PreConditions>
<PreCondition
 Guid="d3cd7a0d-a9ee-430b-9f4b-b7438d4ee678"
>Terminal2.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.NoConnection</PreCondition></PreConditions>
<Expression>Terminal1.RBCConnection</Expression>
</Case><Case
 Name="RBC2"
 Guid="71411cb1-fbc3-4d56-8c9e-a2ac172c6983"
>
<Expression>Terminal2.RBCConnection</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Implemented="TRUE"
 Name="AllSessionsClosed"
 Guid="d5ab709a-c73f-4f2a-bece-c9c7586dcde5"
>
<ReqRef
 Id="abbd517e-8b49-43b4-8dfa-117c8988fa86"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0dc0a5ce-e9ad-4e66-9089-3cd52c0eb9cc"
>
</ReqRef><Comment>Indicates if all the Euroradio sessions are closed</Comment>
<Cases>
<Case
 Name="Value"
 Guid="570d8238-c486-4d19-bd40-02645a6b780e"
>
<Expression>Terminal1.RBCConnection.ConnectionState in RBCStruct.ConnectionStateSM.Inactive
  AND
Terminal2.RBCConnection.ConnectionState in RBCStruct.ConnectionStateSM.Inactive</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Implemented="TRUE"
 Name="OneMobileTerminalIsAvailable"
 Guid="e31f0ce4-5ca7-4615-9f01-e835968b6bb2"
>
<ReqRef
 Id="d88669ab-b014-4a92-b565-0f1e46f40945"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8ea3d211-ac31-4faa-8ba9-4587b570b2aa"
>
</ReqRef><Comment>Indicates if at least one terminal is available.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="8a425b2a-af9b-4a02-9cbc-8d1d15189bb3"
>
<Expression>Terminal1 != EMPTY
  OR
Terminal2 != EMPTY</Expression>
</Case></Cases>
</Function><Function
 Type="ContactActionEnum"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ConvertActionToPerform"
 Guid="fcc7735a-3e46-4160-a9cb-7124ea1d73e6"
>
<Comment>Converts the value received from the trackside to ContactActionEnum</Comment>
<Parameters>
<Parameter
 Type="Messages.Q_RBC"
 Name="anAction"
 Guid="2dc3f1b7-07ef-4192-a904-45caa04da49c"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Establish"
 Guid="ceb08062-d72f-4cf5-877d-121ebb9ea7f9"
>
<PreConditions>
<PreCondition
 Guid="25b870bb-f06f-4a6d-b140-b8e5998a1b3f"
>anAction == Messages.Q_RBC.Establish_communication_session</PreCondition></PreConditions>
<Expression>ContactActionEnum.Establish</Expression>
</Case><Case
 Name="Terminate"
 Guid="5e2d31e6-1284-446b-bd20-6f8fb35aa180"
>
<Expression>ContactActionEnum.Terminate</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ConvertAppliesToSleepingUnits"
 Guid="71777804-f6af-463a-a0cd-be78c7cf123a"
>
<Comment>Converts the value indicating if the order applies to sleeping units to boolean</Comment>
<Parameters>
<Parameter
 Type="Messages.Q_SLEEPSESSION"
 Name="aValue"
 Guid="95b89cca-bddd-4920-a537-2f4c90e311f0"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Applies to sleeping units"
 Guid="41f4167f-b8bf-4f20-80a1-09bccc192889"
>
<PreConditions>
<PreCondition
 Guid="7de92c40-a560-4c7c-8c3e-4d25a94f310c"
>aValue == Messages.Q_SLEEPSESSION.Execute_session_establishment_order</PreCondition></PreConditions>
<Expression>True</Expression>
</Case><Case
 Name="Doesn&apos;t apply to sleeping units"
 Guid="8de8ad88-30a2-4af6-b6a2-186d840a815d"
>
<Expression>False</Expression>
</Case></Cases>
</Function><Function
 Type="SafeRadioConnectionStatusEnum"
 Implemented="TRUE"
 Name="SafeRadioConnectionStatus"
 Guid="ac5710b4-af55-4138-9865-c2e469eb9c9b"
>
<ReqRef
 Id="747bae2e-7720-4f04-ac58-bf2f7feb9e50"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5b443be0-00c4-4831-b78c-0cd8f104ab16"
>
</ReqRef><Comment>Provides the safe radio connection status of the active connection.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="61ae260c-2217-4637-89fc-9c073942c53b"
>
<Expression>CurrentRBCConnection().SafeRadioConnectionStatus</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Implemented="TRUE"
 Name="MobileTerminalRegisteredToNetwork"
 Guid="af2b63fd-7a74-4d0c-9dd5-640bccd97f2c"
>
<ReqRef
 Id="65314800-5286-475e-b755-60e19e8cb01d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="86dca3f3-96a5-4716-aab2-e171d185f8eb"
>
</ReqRef><ReqRef
 Id="25c7ba02-1985-488d-b506-b24eef2b11b4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="21560c78-c017-4f92-82b7-164ed6fbfc5a"
>
</ReqRef><ReqRef
 Id="ff5aeaff-49e3-489d-816f-c49fc05bc951"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5ffddbae-852a-4c6a-b270-2c53874223d9"
>
</ReqRef><Comment>Indicates if at least one mobile terminal is registered to a Radio Network.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="8d5b3f0d-e99a-4b78-a893-b7f25eb488a9"
>
<Expression>Terminal1.IsRegistered
  OR
Terminal2.IsRegistered</Expression>
</Case></Cases>
</Function><Function
 Type="MobileTerminalStruct"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="CurrentTerminal"
 Guid="1578f217-c304-4c22-98c7-cb41f87ae7b7"
>
<Comment>Provides the current terminal.</Comment>
<Cases>
<Case
 Name="Connection opened on terminal 1"
 Guid="688a99fe-65fa-4958-83a1-fd990459de79"
>
<PreConditions>
<PreCondition
 Guid="c3452b29-ef21-4a6f-88bd-7ae9c80cd9da"
>Terminal1.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.ConnectionUp</PreCondition></PreConditions>
<Expression>Terminal1</Expression>
</Case><Case
 Name="Connection opened on terminal 2"
 Guid="909b1669-a4a2-4bb4-a8f8-ad28926921a0"
>
<PreConditions>
<PreCondition
 Guid="fb0f7a9d-b7ff-43e8-80d1-cb8b82186a20"
>Terminal2.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.ConnectionUp</PreCondition></PreConditions>
<Expression>Terminal2</Expression>
</Case><Case
 Name="Terminal 2 is not registered"
 Guid="cdd75c3d-6b70-4b5c-a649-53a129d44fbc"
>
<PreConditions>
<PreCondition
 Guid="32745b2d-c50e-46dd-96a8-b56db9fb8695"
>NOT Terminal2.IsRegistered</PreCondition></PreConditions>
<Expression>Terminal1</Expression>
</Case><Case
 Name="Terminal 2 is registered"
 Guid="66f6b667-960f-4fec-b6ee-96b6cf589e21"
>
<Expression>Terminal2</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Implemented="TRUE"
 Name="SessionIsAlreadyEstablishedWithRequestedRBC"
 Guid="c4eccae5-0e53-41e7-af15-9608b3f9878d"
>
<ReqRef
 Id="66543af0-6c4b-46a0-b17f-96ed3e1d37ba"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="26d3911c-cdb4-4242-8981-7159f2405edd"
>
</ReqRef><Comment>Indicates if the session is already established with the requested RBC.

It can only return false if there is no open session or if the last known RBC has to be contacted and the id of the currenly connected RBC corresponds to the last known RBC id.</Comment>
<Cases>
<Case
 Name="No open session"
 Guid="bdb5d993-9c32-4855-adcf-db92b3936ac0"
>
<PreConditions>
<PreCondition
 Guid="8455685c-d8f8-43ba-96b6-445565f557cb"
>AllSessionsClosed()</PreCondition></PreConditions>
<Expression>False</Expression>
</Case><Case
 Name="Contact last known RBC"
 Guid="64d6f106-510a-4e1f-84b6-125c437a5319"
>
<PreConditions>
<PreCondition
 Guid="bcb10fd3-510d-4c90-bae8-f07439b7b2bf"
>ContactOption == ContactOptionEnum.ContactLastKnownRBC</PreCondition><PreCondition
 Guid="5681dc01-53e7-409e-9433-13e0c39fa57b"
>LastKnownRBC.Id != CurrentRBCConnection().ContactData.Id</PreCondition></PreConditions>
<Expression>False</Expression>
</Case><Case
 Name="Otherwise"
 Guid="0996c4d0-015e-467b-a61e-cc13846a6c74"
>
<Expression>True</Expression>
</Case></Cases>
</Function><Function
 Type="SystemVersionEnum"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="ConvertSystemVersion"
 Guid="83ef1cc8-6c4b-404d-9e99-8966e74cb8ae"
>
<Comment>Converts the system version received from the trackside to the SystemVersionEnum.</Comment>
<Parameters>
<Parameter
 Type="Messages.M_VERSION"
 Name="aVersion"
 Guid="f772ea4e-ee2a-4ce1-bdea-258aa519747b"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Version1_0"
 Guid="a18bf2de-3a3a-45c5-8b64-aaced5f3aa55"
>
<PreConditions>
<PreCondition
 Guid="423e3c04-66ea-4d36-94d7-78e0034ef428"
>aVersion == Messages.M_VERSION.Version_1_0__introduced_in_SRS_1_2_0_and_re_used_in_SRSs_2_0_0__2_2_2__2_3_0</PreCondition></PreConditions>
<Expression>SystemVersionEnum.Version1_0</Expression>
</Case><Case
 Name="Version1_1"
 Guid="2220f792-2ec9-4a60-87d1-1328f7f93996"
>
<PreConditions>
<PreCondition
 Guid="a22a98f6-8ad4-4227-b1f9-c618de4f7c04"
>aVersion == Messages.M_VERSION.Version_1_1__introduced_in_SRS_3_0_0</PreCondition></PreConditions>
<Expression>SystemVersionEnum.Version1_1</Expression>
</Case><Case
 Name="Version2_0"
 Guid="a98094e3-1ecd-4bcc-a9ec-299b926c0fab"
>
<PreConditions>
<PreCondition
 Guid="f4f56c58-c98b-415b-b10f-834a43d8bdb0"
>aVersion == Messages.M_VERSION.Version_2_0__introduced_in_SRS_3_0_0</PreCondition></PreConditions>
<Expression>SystemVersionEnum.Version2_0</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 Implemented="TRUE"
 Name="ContactRBC"
 Guid="d105e077-5c97-4b2b-97a0-538f17fd7201"
>
<ReqRef
 Id="951fc6d8-739b-4bd4-9361-5686840e8b5a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="819e1e79-9b39-4782-b8f6-2e8ef581405d"
>
</ReqRef><ReqRef
 Id="e65aa492-e72e-4bdc-896b-8462bf7b8ea9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="186a859f-0ee2-4458-8b0b-f471f0cbdf5e"
>
</ReqRef><ReqRef
 Id="e4addba5-4948-4054-b3dc-0e7eeabd6768"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="18a671d3-8767-4b2f-ba96-f58870ebde49"
>
</ReqRef><Comment>Allows to establish/terminate the communication session with an RBC.</Comment>
<Parameters>
<Parameter
 Type="ContactOrderStruct"
 Name="Order"
 Guid="bd7c227e-3f2a-4591-b2f2-0261dead5db0"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Select RBC"
 Guid="d8aeb849-b368-455f-9c7b-b9df2fe98385"
>
<Comment>Selection of RBC according to their communication status.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Terminal1"
 Guid="0e5a581a-1201-405e-b00a-40ae760b28f2"
>
<Comment>Terminal1 is the default terminal. If none of terminals are connected, then the connection will be established on the Terminal1. If the connection is already established on this terminal, then it will be closed and the new connection will be opened.</Comment>
<PreConditions>
<PreCondition
 Guid="8df44f1d-8bc6-47ea-9994-67dde1dc64c4"
>Terminal2.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.NoConnection</PreCondition></PreConditions>
<Actions>
<Action
 Guid="fb0c323a-04ee-47a6-86cd-341b24a90ee3"
>Terminal1.RBCConnection.ContactRBCOrder &lt;- Order</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Terminal2"
 Guid="78b179e8-af95-448d-a830-a24a276f6974"
>
<Comment>If the connection is already established on the second mobile terminal, then it will be closed and a new connection will be opened.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="2086e972-9bf9-41fd-bbac-eef71aecabe9"
>Terminal2.RBCConnection.ContactRBCOrder &lt;- Order</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="ContactAcceptingRBC"
 Guid="9fc2337d-7e64-41d1-a72d-a19a466b8342"
>
<ReqRef
 Id="711a8f6b-f758-4405-bb80-f9b331940c39"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8be15c32-7c74-4fb5-8e55-06b822994013"
>
</ReqRef><ReqRef
 Id="e65aa492-e72e-4bdc-896b-8462bf7b8ea9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7d4f24b0-92a9-4856-a71d-88e34d2d59ac"
>
</ReqRef><Comment>Allows to establish the communication session with an accepting RBC.</Comment>
<Parameters>
<Parameter
 Type="ContactOrderStruct"
 Name="Order"
 Guid="36d1affc-3e90-44a1-bafa-74605373535b"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Select RBC"
 Guid="0cdba42d-a87d-4fbb-b448-ea7fd7ae4fd1"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Terminal1"
 Guid="3d112c45-c399-4909-9c57-0b56d8c93b57"
>
<Comment>If the second mobile terminal is already connected, then the connection will be established on the first one.</Comment>
<PreConditions>
<PreCondition
 Guid="ffda9f58-de4b-460e-9459-f56d2e21d0d9"
>Terminal2.RBCConnection.SafeRadioConnectionStatus == SafeRadioConnectionStatusEnum.ConnectionUp</PreCondition></PreConditions>
<Actions>
<Action
 Guid="26ca8f48-278e-43b7-b3a9-85398b8d2fc7"
>Terminal1.RBCConnection.ContactRBCOrder &lt;- ContactOrderStruct
{
    Id =&gt; Order.Id,
    PhoneNumber =&gt; Order.PhoneNumber,
    ActionToPerform =&gt; ContactActionEnum.Establish,
    AppliesToSleepingUnits =&gt; Order.AppliesToSleepingUnits
}</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Terminal2"
 Guid="0f6ccc7b-209c-482c-a596-433da0ec4386"
>
<Comment>If the first mobile terminal is already connected, the connection will be established on the second one.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="73ee1e00-5c33-49e9-a6b2-2b8018da8475"
>Terminal2.RBCConnection.ContactRBCOrder &lt;- ContactOrderStruct
{
    Id =&gt; Order.Id,
    PhoneNumber =&gt; Order.PhoneNumber,
    ActionToPerform =&gt; ContactActionEnum.Establish,
    AppliesToSleepingUnits =&gt; Order.AppliesToSleepingUnits
}</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="OpenRBCSession"
 Guid="1e3e4aab-936d-4b3e-90d0-c39dfa476afa"
>
<ReqRef
 Id="410ad67d-6b5a-46f5-9694-35e5954fcb65"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="882474cc-7ade-45b2-a1e4-47af0e562d10"
>
</ReqRef><ReqRef
 Id="becb430f-a4f2-4817-ad08-3672ed05f855"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d1ee1871-11f4-4b57-9cd4-1613cfc9d0a7"
>
</ReqRef><Comment>Initiates the contact with the RBC, as requested by ContactOption.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Open RBC session"
 Guid="96a4a42f-501a-40c4-9a82-8d522f07c55a"
>
<Comment>Initiates the contact with the RBC, as requested by ContactOption.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Session is already (being) established with this RBC"
 Guid="caa5317d-7334-450b-a354-799705c2362d"
>
<ReqRef
 Id="66543af0-6c4b-46a0-b17f-96ed3e1d37ba"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="887d02f6-5b47-4eeb-9c9d-b558136b3ec4"
>
</ReqRef><Comment>If a session is already (being) established with this RBC, the order is ignored.</Comment>
<PreConditions>
<PreCondition
 Guid="dd160343-60f0-4795-ae66-17e29ea4cd14"
>SessionIsAlreadyEstablishedWithRequestedRBC()</PreCondition></PreConditions>
<Actions>
</Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Contact last known RBC"
 Guid="f01fc2bf-5429-4449-a4de-036700e0a472"
>
<ReqRef
 Id="69dc4eed-7cae-45b6-adbb-58b2b1ac6edd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9c020d93-6490-4b5e-be20-c6d0443f3740"
>
</ReqRef><ReqRef
 Id="369d7ae0-50db-411b-9941-bbe30e354733"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="06f42b1f-3ae0-42a2-8cee-ca8119a0ce18"
>
</ReqRef><Comment>Contact last known RBC. If there is no valid last known RBC stored on-board, the order is ignored.</Comment>
<PreConditions>
<PreCondition
 Guid="b800f70b-83f7-45b4-9432-c769f9dca3f6"
>ContactOption == ContactOptionEnum.ContactLastKnownRBC</PreCondition><PreCondition
 Guid="c12c7ead-1138-41ac-bb3b-164fdeda2b0e"
>LastKnownRBC.DataState == DataState.Valid</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2078f218-6c1c-485a-9a00-f77a91524075"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; LastKnownRBC.Id,
        PhoneNumber =&gt; LastKnownRBC.PhoneNumber,
        ActionToPerform =&gt; ContactActionEnum.Establish
    }
)</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Use on-board stored short number"
 Guid="862bab30-ca83-421f-999b-a05239d001d6"
>
<ReqRef
 Id="40859515-77c4-46aa-96a5-12453cd171a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="82f9117e-6a4e-4124-8891-6c82527765c5"
>
</ReqRef><Comment>Use on-board store short number.</Comment>
<PreConditions>
<PreCondition
 Guid="44730a03-b518-420f-86e0-c7c20a7a8fc6"
>ContactOption == ContactOptionEnum.UseOnBoardStoredShortNumber</PreCondition></PreConditions>
<Actions>
<Action
 Guid="5dd1dd73-af6c-4f90-99d8-db129a45167f"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; CurrentRBCConnection().ContactData.Id,
        PhoneNumber =&gt; ShortNumber,
        ActionToPerform =&gt; ContactActionEnum.Establish
    }
)</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Use RBC id + phone number"
 Guid="191d7715-3f6a-4e80-856b-e904fa4f1342"
>
<ReqRef
 Id="cebfc056-7b96-49d7-a6ff-1fdf0076bb9e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e7fc21dd-a91f-44fb-a8a0-321f2a70b430"
>
</ReqRef><Comment>Use RBC id + phone number.</Comment>
<PreConditions>
<PreCondition
 Guid="a96e13e9-b470-4d73-9b24-98a3929baf63"
>ContactOption == ContactOptionEnum.RBCIdAndPhoneNumber</PreCondition></PreConditions>
<Actions>
<Action
 Guid="9f928072-675b-4a55-a3b6-da40798f6286"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; CurrentRBCConnection().ContactData.Id,
        PhoneNumber =&gt; CurrentRBCConnection().ContactData.PhoneNumber,
        ActionToPerform =&gt; ContactActionEnum.Establish
    }
)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="CloseRBCSession"
 Guid="2691fd9c-77e5-40c8-859a-310f132a7a1c"
>
<ReqRef
 Id="058ba686-ff06-4bed-b616-68b4fb4ea7fd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b1781efd-43f9-4cb5-be4a-bc6450114f28"
>
</ReqRef><ReqRef
 Id="84374b3d-739e-4c5f-909d-4c138dedec38"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bb496d49-ec11-41dc-befc-da7c8c5407fa"
>
</ReqRef><ReqRef
 Id="83709cd5-3863-48a0-8264-34f65a482b28"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="85a4bcf7-b532-435d-9f05-b6444ea4586a"
>
</ReqRef><ReqRef
 Id="ae649b47-cdfc-4223-b13d-4b1efaef612d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4c6d8d20-0b10-4548-aafc-35837ff10e5f"
>
</ReqRef><Comment>Closing an RBC connection corresponds to an order to contact the current RBC with action &quot;Terminate&quot;.</Comment>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Close the session"
 Guid="b37006ef-5ce5-4c15-9dd8-55ec01214286"
>
<Comment>TODO: to be implemented</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Close the session"
 Guid="4446a776-8c46-438a-8b89-c979faf871ba"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="9c41a20d-c457-4bed-8e73-8106d54cde3b"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; CurrentRBCConnection().ContactData.Id,
        PhoneNumber =&gt; CurrentRBCConnection().ContactData.PhoneNumber,
        ActionToPerform =&gt; EURORADIO.ContactActionEnum.Terminate
    }
)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="ContactRIU"
 Guid="7d0b4122-12aa-4a02-83f7-9d7e322bfa8a"
>
<ReqRef
 Id="64296fc8-fe88-499d-b63e-d570a4a39744"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a1610f43-4036-4fca-9eef-bd1d8216dfa5"
>
</ReqRef><Comment>Allows to establish/terminate the communication session with an RIU.</Comment>
<Parameters>
<Parameter
 Type="ContactOrderStruct"
 Name="Order"
 Guid="b9ea4cb2-277a-4de4-863a-f74f28a202a2"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Contact RIU"
 Guid="41b28c18-f309-4e57-8d84-85c6374626b2"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Contact RIU"
 Guid="908bf858-c395-40d2-8235-08a1bc78e393"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="d73c602a-7643-4127-a75a-809495d5acbb"
>RIU.ContactRIUOrder &lt;- Order</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="TracksideOrderedSessionReceived"
 Guid="aa947d6d-5ed0-4cb9-9175-d6bbf385946c"
>
<ReqRef
 Id="af0db000-6b09-4a25-b01b-439fa27cbc6a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2dc771ca-4061-4cb2-adb7-816a3d7b329e"
>
</ReqRef><ReqRef
 Id="18318a83-420a-41a7-b3eb-e4e67f1e3f97"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d1b0f107-721b-4cd0-8df4-da9d7387b4bf"
>
</ReqRef><ReqRef
 Id="e4addba5-4948-4054-b3dc-0e7eeabd6768"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="03c225c5-d245-4024-9654-d3747c342eb4"
>
</ReqRef><Comment>Handles reception of session management packet from the trackside. The procedure calls ContactRBC procedure wich order computed from the received information.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.SESSION_MANAGEMENT.Message"
 Name="Packet"
 Guid="d3881c83-afc8-4e4b-aaa6-e10fc539514f"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle trackside order"
 Guid="432c07cc-89ff-4dc7-aa9f-e8aacd9867d0"
>
<Comment>Handles reception of session management packet from the trackside. The rule calls ContactRBC procedure wich order computed from the received information.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Contact information provided by the packet"
 Guid="a1967dcf-c7b2-477d-a589-c2dc4de30508"
>
<ReqRef
 Id="cebfc056-7b96-49d7-a6ff-1fdf0076bb9e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0a0571a8-3af1-44b4-8760-c3e5cb384074"
>
</ReqRef><Comment>If the contact information is provided by the packet (no special values in NID_RBC or NID_RADIO), then the order can be created with these values.</Comment>
<PreConditions>
<PreCondition
 Guid="7b666480-3ecb-4c96-8c61-ffca7307d3f0"
>Packet.NID_RBC != Messages.NID_RBC.contact_last_known_RBC</PreCondition><PreCondition
 Guid="cfb7f6d4-38c4-4b3c-8c66-f6f85d58f314"
>Packet.NID_RADIO != &apos;FFFFFFFFFFFFFFFF&apos;</PreCondition></PreConditions>
<Actions>
<Action
 Guid="a6ebac2e-aa73-4d15-b591-4cdeeb13852b"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; RBCIdStruct
        {
            Country =&gt; Packet.NID_C,
            Id =&gt; Packet.NID_RBC
        },
        PhoneNumber =&gt; Packet.NID_RADIO,
        ActionToPerform =&gt; ConvertActionToPerform ( Packet.Q_RBC ),
        AppliesToSleepingUnits =&gt; ConvertAppliesToSleepingUnits ( Packet.Q_SLEEPSESSION)
    }
)</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Contact last known RBC"
 Guid="83b37f06-70a4-46e7-8c47-7c7d23261d65"
>
<ReqRef
 Id="369d7ae0-50db-411b-9941-bbe30e354733"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f252f718-1e31-4681-b313-39faa0912928"
>
</ReqRef><ReqRef
 Id="31fff3ff-41dc-41fb-9f2e-b43b04a91e5e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9bd57e09-46a8-4e53-9d23-73a2713355ad"
>
</ReqRef><ReqRef
 Id="69dc4eed-7cae-45b6-adbb-58b2b1ac6edd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="61312243-54c8-4f97-8fba-9d4e9873d62c"
>
</ReqRef><Comment>If the packet asks to contact the last known RBC and this information is available, then it is used to create to order. Otherwise the order is ignored.</Comment>
<PreConditions>
<PreCondition
 Guid="3b4b580e-3c79-489d-a09a-403729e158a8"
>Packet.NID_RBC == Messages.NID_RBC.contact_last_known_RBC</PreCondition><PreCondition
 Guid="ed774a24-cf60-4ff7-a891-167c4f37b771"
>LastKnownRBC != EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="21f26d0a-7720-431b-a2c8-aa7386d415c0"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; RBCIdStruct
        {
            Country =&gt; LastKnownRBC.Id.Country,
            Id =&gt; LastKnownRBC.Id.Id
        },
        PhoneNumber =&gt; LastKnownRBC.PhoneNumber,
        ActionToPerform =&gt; ConvertActionToPerform ( Packet.Q_RBC ),
        AppliesToSleepingUnits =&gt; ConvertAppliesToSleepingUnits ( Packet.Q_SLEEPSESSION)
    }
)</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Use on-board stored short number"
 Guid="851df2b3-550c-43a1-a88a-4e153544c8bf"
>
<ReqRef
 Id="40859515-77c4-46aa-96a5-12453cd171a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8a3656cd-43f6-42e7-8d65-fa07d75ecd3f"
>
</ReqRef><ReqRef
 Id="f8152593-9f99-41a4-9ae8-b51e619e6ece"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1f68f5f4-47cd-4fdc-b805-884a22003510"
>
</ReqRef><ReqRef
 Id="5f82380a-e109-4aba-90d2-9062db8ac675"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="22b090a3-8bd5-4a4c-b5bd-c7de0e0dba4b"
>
</ReqRef><Comment>If the packet asks to use the short number, then the order is created from the RBC id provided by the packet + the short number stored on-board.</Comment>
<PreConditions>
<PreCondition
 Guid="22232e5b-8c7d-4811-8464-469786240a65"
>Packet.NID_RADIO == &apos;FFFFFFFFFFFFFFFF&apos;</PreCondition></PreConditions>
<Actions>
<Action
 Guid="81f8e818-3b94-4484-9cb1-2ae9a62240e9"
>ContactRBC
(
    Order =&gt; ContactOrderStruct
    {
        Id =&gt; RBCIdStruct
        {
            Country =&gt; Packet.NID_C,
            Id =&gt; Packet.NID_RBC
        },
        PhoneNumber =&gt; ShortNumber,
        ActionToPerform =&gt; ConvertActionToPerform ( Packet.Q_RBC ),
        AppliesToSleepingUnits =&gt; ConvertAppliesToSleepingUnits ( Packet.Q_SLEEPSESSION)
    }
)</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="RegisterMobileTerminals"
 Guid="51a30ec7-ce1f-46f1-a57c-72cb7965af62"
>
<ReqRef
 Id="0d0678a7-632a-4a9e-9a4a-87d46d1383b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="98d92943-9b78-430b-a271-7935c2cb0a2f"
>
</ReqRef><ReqRef
 Id="865bbdd6-2010-4869-ab3e-bc538ce5fe4b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="384307ff-cbf9-4473-b59e-a03b4fa28aa9"
>
</ReqRef><Comment>Registers the mobile terminals to a radio network.</Comment>
<Parameters>
<Parameter
 Type="String"
 Name="aNetworkId"
 Guid="06100028-08c1-4f2b-9385-ab9e1edc17bc"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Register mobile terminals"
 Guid="86956c33-030e-4d1f-8f75-ab22dffbfcdd"
>
<Comment>If the provided id is valid or the last known nework id is valid, then the mobile terminals are registered.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Provided id is valid"
 Guid="615728d0-acd8-40e3-94ea-aebf1f7bfc01"
>
<Comment>If the provided id is valid, it is used to register the terminals.</Comment>
<PreConditions>
<PreCondition
 Guid="e65e63b1-fd62-4950-b031-05d1d1109e1c"
>aNetworkId != &apos;&apos;</PreCondition></PreConditions>
<Actions>
<Action
 Guid="78ee6641-812f-4c2a-afbe-b0e4ada5e038"
>Terminal1.NetworkId &lt;- aNetworkId</Action><Action
 Guid="7e15aeae-1d77-4d69-b5b6-eb9e447e9574"
>Terminal2.NetworkId &lt;- aNetworkId</Action><Action
 Guid="c6f1daed-dbca-4284-aa54-e5ac33091cd8"
>Terminal1.IsRegistered &lt;- True</Action><Action
 Guid="388ad4df-54c2-4018-b273-2df2b20e73c2"
>Terminal2.IsRegistered &lt;- True</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Otherwise, use the default Radio Network id"
 Guid="c02b6e39-340c-4bf8-a4fd-910b6087bc05"
>
<ReqRef
 Id="5e068e1e-2be5-45b6-b9eb-d1151df93748"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9092e686-fa55-4fa2-93f9-8086146ec060"
>
</ReqRef><Comment>Otherwise the default Radio Network id is used.</Comment>
<PreConditions>
<PreCondition
 Guid="301efa69-de1e-4a8d-a59f-c0c7afcbe928"
>DefaultRadioNetworkId != &apos;&apos;</PreCondition></PreConditions>
<Actions>
<Action
 Guid="25c3fc69-9b60-4bb1-a2d1-b74d2cd381a9"
>Terminal1.NetworkId &lt;- DefaultRadioNetworkId</Action><Action
 Guid="f0f8c48f-c368-4d6f-a81c-0925a124f02b"
>Terminal2.NetworkId &lt;- DefaultRadioNetworkId</Action><Action
 Guid="e3be1ede-90b1-4290-b919-3187a1668b3c"
>Terminal1.IsRegistered &lt;- True</Action><Action
 Guid="bfda7ae5-0601-4e02-9f74-ce16bf82c901"
>Terminal2.IsRegistered &lt;- True</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Update last known network id"
 Guid="bfb78b5e-119a-4e09-af0e-35138fc12848"
>
<ReqRef
 Id="9bf96521-7fd6-4183-ab61-1276d48d3996"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6901fdd4-16ee-4f98-bee3-2fea0d726482"
>
</ReqRef><Comment>The received network id is memorized in order to be able to use it when the on-board equipment is powered-on.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Update last known network id"
 Guid="908aae06-faac-4683-acfa-a0943eeb9c8f"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="e1e7e813-961e-4771-8bdc-7606677f8c40"
>EURORADIO.LastKnownNetworkId &lt;- aNetworkId</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 NeedsRequirement="FALSE"
 Name="ProcessIncomingMessages"
 Guid="b9ea4dd2-c1d7-457b-b33c-62e49af0c65b"
>
<Comment>This procedure is called for each message received from the Euroradio. It stores the received information into the internal variables.</Comment>
<Parameters>
<Parameter
 Type="Messages.MESSAGE.TRACK_TO_TRAIN.Message"
 Name="aMessage"
 Guid="72113823-2b1b-43bb-b457-15bf4f1f449d"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="SR authorisation"
 Guid="e847d1b0-8be3-41a3-8ffd-43e655a3a124"
>
<ReqRef
 Id="6dc87cd2-d3b8-4d7f-a8f0-26e60b30a71e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="658de14c-3157-4d55-84fd-a580054731dc"
>
</ReqRef><ReqRef
 Id="d97a231f-6ef1-4300-9bd9-d3dba7d434bd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="75b6b428-5a43-4df5-aa76-0990b37dbfe2"
>
</ReqRef><Comment>Handles reception of SR authorisation.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SR authorisation"
 Guid="d118d140-ad45-45ff-852f-8cb03f830fa2"
>
<PreConditions>
<PreCondition
 Guid="aae29d37-06e2-4a68-af77-695ecbbe2651"
>Available ( aMessage.SR_AUTHORISATION )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="80d3a386-cf7c-4ca1-91f3-31d8046462f2"
>Kernel.SR.SRAuthorisationReceived ( Packet =&gt; aMessage.SR_AUTHORISATION )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Movement authority"
 Guid="626962c6-9ca8-4901-8a62-680c26f7dc7a"
>
<ReqRef
 Id="948cdca7-999f-4b57-8b4a-7ffc1873927f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="93b1df7b-3be7-4595-ac53-eb958ee1749c"
>
</ReqRef><ReqRef
 Id="f4723221-15fd-4636-851f-08a437cc18e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8ac4a4f7-3e5f-4335-b743-e8ee7a7ce385"
>
</ReqRef><ReqRef
 Id="34124e11-dd20-40b4-8914-44b6b7397ff1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8d52b2e1-2ae4-4fa4-a15b-a79f20a19041"
>
</ReqRef><ReqRef
 Id="ecaefeed-fa89-4186-b8b7-e63999df3603"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ffd2cec2-5da8-422b-a8c6-5fc4ce9751ba"
>
</ReqRef><ReqRef
 Id="c04116c0-24b6-4d81-ae02-cff4fa993bef"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8fa0eaad-3da8-4e2a-b7c5-92f4db5a720d"
>
</ReqRef><Comment>Handles reception of the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Movement authority"
 Guid="b2ace9c6-9fcd-4829-b42f-393341b8a143"
>
<PreConditions>
<PreCondition
 Guid="cc9777a1-c95d-4abd-9469-632ab302b08b"
>Available ( aMessage.MOVEMENT_AUTHORITY )</PreCondition><PreCondition
 Guid="0a1244f7-fc1f-4b75-b7ab-0ca339366842"
>NOT (THERE_IS_IN Kernel.EmergencyStops | X.Reason == Kernel.BrakeReason.OrderFromRBC)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="34f6db8a-45cd-4c94-b8e3-83e7ea450181"
>Kernel.MA.MALvl2or3Received
(
    Packet =&gt; aMessage.MOVEMENT_AUTHORITY.LEVEL_2_3_MOVEMENT_AUTHORITY,
    NID_BG =&gt; aMessage.MOVEMENT_AUTHORITY.NID_LRBG
)</Action></Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Session management received"
 Guid="8ad12600-a556-4799-9fac-e2046bd24f25"
>
<ReqRef
 Id="18318a83-420a-41a7-b3eb-e4e67f1e3f97"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="60138c61-9928-4a2e-8baa-0f31947c0fea"
>
</ReqRef><ReqRef
 Id="ff45f18e-7a7b-412e-8847-569b6605d632"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8313af48-55a8-4bd6-88c6-a7b6c2534cc5"
>
</ReqRef><Comment>Handles reception of session management received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Session management received"
 Guid="6abe06d6-af4e-4e14-890c-086b61321719"
>
<PreConditions>
<PreCondition
 Guid="35f50585-8b45-4d82-b3a2-42514806c6aa"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="7b01bf6b-5aaa-4c43-9da2-5e2212b1886c"
>TracksideOrderedSessionReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )).SESSION_MANAGEMENT )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="6952e078-ee86-43d6-84ef-44a7987c6f51"
>
<ReqRef
 Id="e832ef89-d8d7-4e89-86eb-ba4c29d6d5fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="34d33893-3280-45dc-9cda-903fabe88e9a"
>
</ReqRef><Comment>Handles reception of report parameters received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="b3006b05-322a-4ec3-adaf-f31c462e909a"
>
<ReqRef
 Id="8e46d1f9-ece2-43e9-9a45-e2978111a3dc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="83cda4d2-8fed-4ae3-bb4e-fccc5f09ca44"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="4e66790e-11e3-42ae-9f8a-5c70586ffac3"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.POSITION_REPORT_PARAMETERS )</PreCondition><PreCondition
 Guid="ce0a957f-db4d-48fe-abd1-16ae231136fe"
>aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE == EMPTY</PreCondition><PreCondition
 Guid="b72cbd16-8ee3-43c1-8931-f3202d3cec34"
>aMessage.GENERAL_MESSAGE == EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="aea31b9a-b403-4674-ba05-b2e0e573cd40"
>PositionReport.UpdatePositionReportParameters(
  (FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1  | Available(X.POSITION_REPORT_PARAMETERS)).POSITION_REPORT_PARAMETERS
)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="List of balises for SH area received"
 Guid="fcf5520f-ce3c-4f17-b984-02a819e47adb"
>
<ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c0e24bd2-6d1d-4cc1-b3d3-ed16112b088a"
>
</ReqRef><Comment>Handles reception of the list of balises for SH area received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="List of balises for SH area received"
 Guid="1ac428d8-87fc-45d9-a277-e609c689b426"
>
<PreConditions>
<PreCondition
 Guid="50fdfdf7-d5b4-4b7a-84b2-11828d779ff0"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.LIST_OF_BALISES_FOR_SH_AREA)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="302b5642-258f-499d-89b3-212a4433b74f"
>Kernel.Shunting.HandleNewListOfBaliseGroups ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.LIST_OF_BALISES_FOR_SH_AREA ) ).LIST_OF_BALISES_FOR_SH_AREA )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="7cc3a1d4-5397-46fd-b656-d5b84b928e94"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="03236951-52f5-449f-976f-3b0a9f5016c1"
>
</ReqRef><Comment>Handles reception of level transition orders received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="1ef92a16-cc7b-4664-9d2b-b735ff9588a4"
>
<PreConditions>
<PreCondition
 Guid="77ad28b3-e1f4-46b8-b1bc-d32e603da92c"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="48dbeb01-ed9a-488f-9c37-1df78daff92f"
>Kernel.LevelTransition.LTOReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )).LEVEL_TRANSITION_ORDER )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="77eaf966-192f-4c0e-9990-7e4897dad4af"
>
<ReqRef
 Id="de18f207-08ba-467b-a877-d3c5a458123d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9a402d46-e655-4ff8-ad35-7229f2ed2f0a"
>
</ReqRef><Comment>Handles reception of mode profile received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="009cc428-70b4-4b0a-b5df-468b677b743e"
>
<PreConditions>
<PreCondition
 Guid="9faa2fda-94d0-4d88-b999-35cbcbcf7f60"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.MODE_PROFILE )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="1d0407c6-42f3-4cd3-9dbd-5721ca7faffe"
>Kernel.MA.ModeProfile.ModeProfileReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.MODE_PROFILE)).MODE_PROFILE )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="e83a4b79-7e77-45ec-b306-cc4f23787f6e"
>
<ReqRef
 Id="3eae43ab-6f26-4908-9360-5a8ce0bec069"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ee9775d6-15df-469d-9f57-45db9fb68014"
>
</ReqRef><Comment>Handles reception of the route suitability data received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="6d8f8b6c-44de-46a3-ad4e-fe9a3f8bd878"
>
<PreConditions>
<PreCondition
 Guid="d17863ff-43e3-41a3-8676-e178880f8608"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.ROUTE_SUITABILITY_DATA )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="6408d9ba-f07f-4dc0-8df8-e66f89eca5d8"
>Kernel.TrackDescription.RouteSuitability.RouteSuitabilityReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1  | Available ( X.ROUTE_SUITABILITY_DATA ) ).ROUTE_SUITABILITY_DATA )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Request to shorten MA"
 Guid="f573cc24-d8e7-4a5a-837b-fcfd15701f42"
>
<ReqRef
 Id="f4723221-15fd-4636-851f-08a437cc18e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="54da9cb4-680f-43b6-b33a-03a77edf5ce4"
>
</ReqRef><ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89f3be06-5ef7-468a-b825-4e1198285de5"
>
</ReqRef><ReqRef
 Id="8430bb84-5228-4341-b64b-f578dfc94604"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d9bcc358-027f-447c-8982-38032c81b0fc"
>
</ReqRef><ReqRef
 Id="ecaefeed-fa89-4186-b8b7-e63999df3603"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7ea53fc6-d681-41e6-9683-e9812a8a9b37"
>
</ReqRef><ReqRef
 Id="20a7a00d-396e-453b-8cd0-0a2ec8f83340"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f1cf6eb2-201c-4dbe-9594-553bc1a6c1ff"
>
</ReqRef><Comment>Handles reception of the request to shorten MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Request to shorten MA"
 Guid="b3c21ffa-a5dc-4ee9-8a69-18a619d2a108"
>
<PreConditions>
<PreCondition
 Guid="324ed534-7ece-4d2d-83d2-634f8405934d"
>Available ( aMessage.REQUEST_TO_SHORTEN_MA )</PreCondition><PreCondition
 Guid="ac3c42b9-2925-4f5d-a63b-8248eade008e"
>NOT (THERE_IS_IN Kernel.EmergencyStops | X.Reason == Kernel.BrakeReason.OrderFromRBC)</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="0118014c-9220-4336-9541-bf8317e774e2"
>
<ReqRef
 Id="de18f207-08ba-467b-a877-d3c5a458123d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2b4661af-9e46-4ac4-9f54-c9ec3eb55d10"
>
</ReqRef><ReqRef
 Id="de18f207-08ba-467b-a877-d3c5a458123d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="745f1f3e-15fd-429b-964b-ea647b81965e"
>
</ReqRef><Comment>Handles reception of the mode profile received with the request to shorten MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="a57d89cc-ee5f-47b4-9486-73125c45cc4d"
>
<PreConditions>
<PreCondition
 Guid="6f406375-f0b0-4331-aa87-fa5c9fcc422c"
>THERE_IS_IN aMessage.REQUEST_TO_SHORTEN_MA.Sequence1 | Available ( X.MODE_PROFILE )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="42923357-d030-4973-8f7e-66c4c0796d02"
>Kernel.MA.ModeProfile.ModeProfileReceived ( Packet =&gt; ( FIRST_IN aMessage.REQUEST_TO_SHORTEN_MA.Sequence1 | Available ( X.MODE_PROFILE)).MODE_PROFILE )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Conditional emergency stop"
 Guid="6219bab3-329e-48c8-ac3b-43208d1cff15"
>
<ReqRef
 Id="4f290d49-e10d-41ae-a385-d9a756df04d3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9643411f-14d6-4b2c-959f-9fdb865d1d3a"
>
</ReqRef><ReqRef
 Id="2b2cca84-5637-4f57-be10-029b36aa0f1a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="463dce3d-0288-4eed-a4c4-19a70f55208e"
>
</ReqRef><ReqRef
 Id="f6e5eaf6-2bea-486e-b3f7-3e854c745b5d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="24f871fa-9964-45bb-a5f8-e1716603f5f0"
>
</ReqRef><Comment>Handles reception of a conditional emergency stop message</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Conditional emergency stop"
 Guid="3c618754-ea0f-49ef-8876-9f2dcb57eaeb"
>
<PreConditions>
<PreCondition
 Guid="7ee563c7-9f56-4ea4-a306-7f427f0e871d"
>Available ( aMessage.CONDITIONAL_EMERGENCY_STOP )</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Verify if the train has passed the stop location"
 Guid="a3dde26d-052a-40b9-91b8-f0946f5668e9"
>
<ReqRef
 Id="e0cce2b4-2341-4ff7-8496-f341142799d3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c654505e-1d72-4ca8-a573-c98379db1ce8"
>
</ReqRef><Comment>If the train has not yet passed the stop location, the emergency stop is stored; otherwise it is rejected.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Train has not reached stop location"
 Guid="906d528d-1a88-4d5d-8ab4-4532dd386338"
>
<Comment>If the train has not yet reached the stop location defined in the message, the stop location is the new EOA and SvL</Comment>
<PreConditions>
<PreCondition
 Guid="b45902ce-1ad5-4544-b07a-efd3ce8b7857"
>Kernel.TrainPosition.FrontEndPosition( PointOfInterest=&gt;DistanceInterval.Min )  &lt; 
Default.MessageTypes.QScaleDistance(
    distance =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.D_EMERGENCYSTOP,
    scale =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.D_EMERGENCYSTOP
)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="13e508f8-8fd5-4eab-af3b-ebd073c96e70"
>Kernel.AddEmergencyStop( aMessage )</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Train has passed stop location"
 Guid="676caee5-da37-43fb-b10b-cfe4fbb2ac70"
>
<Comment>If the train has already passed the stop location, the emergency stop is rejected and the RBC is informed.</Comment>
<PreConditions>
<PreCondition
 Guid="d576cf7f-55e9-49ee-8461-75648e378b60"
>Kernel.TrainPosition.FrontEndPosition( PointOfInterest=&gt;DistanceInterval.Min )  &gt;= 
Default.MessageTypes.QScaleDistance(
    distance =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.D_EMERGENCYSTOP,
    scale =&gt; aMessage.CONDITIONAL_EMERGENCY_STOP.D_EMERGENCYSTOP
)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="40cd1d56-1167-44a7-a25a-cdddeccd30bd"
>CurrentTerminal().RBCConnection.SendAcknowledgementOfEmergencyStop(
    aMessage =&gt; aMessage,
    Qualifier =&gt; Messages.Q_EMERGENCYSTOP.Emergency_stop__Conditional_or_Unconditional__rejected__whatever_the_reason
 )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Unconditional emergency stop"
 Guid="d181ba0c-6ecc-4a2b-9f9b-3d3ea2832731"
>
<ReqRef
 Id="2b2cca84-5637-4f57-be10-029b36aa0f1a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="85d11b25-dd44-4bb1-b9df-67a55173645e"
>
</ReqRef><ReqRef
 Id="0043347f-c382-4046-b7ae-6c3e73575ec6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0a2e1044-20d8-4600-a7ca-c4e2dadc2427"
>
</ReqRef><Comment>Handles reception of an unconditional emergency stop message</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Unconditional emergency stop"
 Guid="2c426004-97a7-4ae6-8fa9-767322005526"
>
<PreConditions>
<PreCondition
 Guid="2a1175db-f9be-4516-b844-38ee6b37cd28"
>Available ( aMessage.UNCONDITIONAL_EMERGENCY_STOP )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="14b50c09-3233-48b7-8e73-bbdeae756ac9"
>Kernel.AddEmergencyStop( aMessage )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="General message"
 Guid="e53756b8-59a0-40ca-aa4c-9eca78feb0b4"
>
<ReqRef
 Id="4dea631e-f3ef-4f67-8232-6d867ebc7c34"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="311ecfe7-ea5c-4667-a285-a1892d7774f7"
>
</ReqRef><ReqRef
 Id="7791130c-94a3-4a45-9437-4a4835707e9a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fc12ef86-a020-42c5-a007-275d305a6e17"
>
</ReqRef><Comment>Handles reception of the general message.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="General message"
 Guid="73ad08e9-e929-4ea4-93c0-5cb635407280"
>
<PreConditions>
<PreCondition
 Guid="379edce7-f62e-4d83-8b49-c4b6bf2389a9"
>Available ( aMessage.GENERAL_MESSAGE )</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="4aa1a01f-4254-4958-b0e8-99b5cb30cc20"
>
<ReqRef
 Id="3eae43ab-6f26-4908-9360-5a8ce0bec069"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="052af9bd-f74a-4e5a-b527-5d0041e154b5"
>
</ReqRef><Comment>Handles reception of the route suitability data received with the general message.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="c0c990ba-89d9-47e6-b458-c64d95c8112c"
>
<PreConditions>
<PreCondition
 Guid="446284a7-38bb-4883-9c06-40ea15d59a53"
>THERE_IS_IN aMessage.GENERAL_MESSAGE.Sequence1 | Available ( X.ROUTE_SUITABILITY_DATA )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="1835b379-689c-41b7-82bd-bafdaa9df3c9"
>Kernel.TrackDescription.RouteSuitability.RouteSuitabilityReceived ( Packet =&gt; ( FIRST_IN aMessage.GENERAL_MESSAGE.Sequence1  | Available ( X.ROUTE_SUITABILITY_DATA ) ).ROUTE_SUITABILITY_DATA )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="935df013-36d5-46e2-8fd1-1c22e87f3dfc"
>
<ReqRef
 Id="e832ef89-d8d7-4e89-86eb-ba4c29d6d5fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3e5938e1-3ca7-41d6-ae46-5f9bca5e096f"
>
</ReqRef><Comment>Handles reception of report parameters received with the general message.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="8f6b94f8-5ebc-4d66-9acf-ddf51ba1d957"
>
<ReqRef
 Id="8e46d1f9-ece2-43e9-9a45-e2978111a3dc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="68ef5d9c-449c-40de-beea-e8affff46386"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="e736f8f8-7e25-47b8-95d9-3641a99d39cb"
>THERE_IS_IN aMessage.GENERAL_MESSAGE.Sequence1 | Available ( X.POSITION_REPORT_PARAMETERS )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="066e716a-07aa-4d5a-a10b-7fc517f0f0b2"
>PositionReport.UpdatePositionReportParameters
(
  ( FIRST_IN aMessage.GENERAL_MESSAGE.Sequence1  | Available ( X.POSITION_REPORT_PARAMETERS ) ).POSITION_REPORT_PARAMETERS
)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="36e96b58-9f40-4919-9b4e-07c2b3fbed30"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fae9450d-113e-4c25-8362-ca7a7290c307"
>
</ReqRef><Comment>Handles reception of level transition orders received with the general message.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="492fa7fb-64bb-408c-99de-c1b404915089"
>
<PreConditions>
<PreCondition
 Guid="aff2ca99-df87-4fce-af4a-c5d94d2935f5"
>THERE_IS_IN aMessage.GENERAL_MESSAGE.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="176f516e-fef3-4f21-b17f-0556e8216f5d"
>Kernel.LevelTransition.LTOReceived ( Packet =&gt;  ( FIRST_IN aMessage.GENERAL_MESSAGE.Sequence1  | Available ( X.LEVEL_TRANSITION_ORDER ) ).LEVEL_TRANSITION_ORDER )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Session management received"
 Guid="617c0d85-e001-4ba2-9a2e-7ed40b53d7d6"
>
<ReqRef
 Id="18318a83-420a-41a7-b3eb-e4e67f1e3f97"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d1a78d9c-b705-485a-827e-46159c8a4b78"
>
</ReqRef><ReqRef
 Id="ff45f18e-7a7b-412e-8847-569b6605d632"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1f2a0132-4a38-4a8a-9ee9-47bc7b5a6e6f"
>
</ReqRef><Comment>Handles reception of session management received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Session management received"
 Guid="1535de84-4fd0-4408-a56b-3b0d008655c4"
>
<PreConditions>
<PreCondition
 Guid="baf54c0d-8b2c-45d1-9b37-f44d09c72b31"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="864aed8d-656b-44ab-97d1-b019cba9aeef"
>TracksideOrderedSessionReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )).SESSION_MANAGEMENT )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="SH authorised"
 Guid="4bb7073f-95bc-4318-8d3f-3caa5247ea0c"
>
<ReqRef
 Id="a9c3b99f-ed94-4e53-9926-e303c3898b8a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e98a66ec-b3a6-46c1-ade8-a2123a480ae2"
>
</ReqRef><ReqRef
 Id="38d45e49-f55c-4765-9dfc-1faf09f9a446"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="eb037c3a-2341-462f-a1b4-cb08fb84ccff"
>
</ReqRef><Comment>Handles reception of shunting authorised.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SH authorised"
 Guid="9df194d9-d435-4491-af34-2b1bdab6c098"
>
<PreConditions>
<PreCondition
 Guid="b6beabb3-2162-4140-bf62-6c441dbea7c6"
>Available ( aMessage.SH_AUTHORISED )</PreCondition></PreConditions>
<Actions>
</Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="MA with shifted location reference"
 Guid="c827bc7f-c31b-4e5b-b1d7-0c40f0977756"
>
<ReqRef
 Id="f4723221-15fd-4636-851f-08a437cc18e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f201ac46-7bc8-4573-abb2-42dd3c495037"
>
</ReqRef><ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c19718f7-8892-4eec-822e-47429c73ee54"
>
</ReqRef><ReqRef
 Id="17ca4691-52af-4571-83b8-d4e345bcc557"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3a85200b-d4dc-4c63-ab3f-58ace0758c7c"
>
</ReqRef><ReqRef
 Id="ecaefeed-fa89-4186-b8b7-e63999df3603"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="375a6cbf-421a-4321-8edd-7f8a1766d267"
>
</ReqRef><ReqRef
 Id="97eca6f5-ba51-4c2e-a71f-3e5752290f21"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="965919c6-b6c4-4cf8-9e69-97d8915441fb"
>
</ReqRef><Comment>Handles reception of MA with shifted location reference.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="MA with shifted location reference"
 Guid="e0951c53-d0ce-491c-8f51-9d84c8f49e55"
>
<PreConditions>
<PreCondition
 Guid="4b26ec5f-a027-4caa-bca8-cd8c1bb56153"
>Available ( aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE )</PreCondition><PreCondition
 Guid="1d3581de-d6a2-4ce9-aa78-ab337178f1a0"
>NOT (THERE_IS_IN Kernel.EmergencyStops | X.Reason == Kernel.BrakeReason.OrderFromRBC)</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="d438dc8b-7936-4bcf-8833-97af765a4527"
>
<ReqRef
 Id="de18f207-08ba-467b-a877-d3c5a458123d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0ed54168-0a74-4d24-88f7-fcbdd7fbf41d"
>
</ReqRef><Comment>Handles reception of mode profile received with MA with shifted location reference.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="5fd08ada-39f6-43b7-bb09-1af3639e5a10"
>
<PreConditions>
<PreCondition
 Guid="4db7c2bd-92a6-46fa-8e2a-21d174da1a53"
>THERE_IS_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.MODE_PROFILE )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="6fc1e57f-7584-4af7-b92a-c41bcf7f6e58"
>Kernel.MA.ModeProfile.ModeProfileReceived ( Packet =&gt; ( FIRST_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.MODE_PROFILE)).MODE_PROFILE )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="2daa150e-f714-4954-9c73-3b6086131c5a"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="43764454-ca9a-4af0-ad98-93c57e99b628"
>
</ReqRef><Comment>Handles receptino of level transition orders with MA with shifted location reference.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="8a7303b3-edcf-4f4a-a210-3b5a94aa69a9"
>
<PreConditions>
<PreCondition
 Guid="47f09839-0138-4c3c-892e-6c8aab01dcd1"
>THERE_IS_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="2a39f497-93ab-442c-bd1a-1f87053a30c5"
>Kernel.LevelTransition.LTOReceived ( Packet =&gt; ( FIRST_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )).LEVEL_TRANSITION_ORDER )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="41514341-5275-4457-b6e1-3d0cdf73210d"
>
<ReqRef
 Id="e832ef89-d8d7-4e89-86eb-ba4c29d6d5fe"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="75394fb1-b13d-4ea8-b0ae-b8da4e554e2c"
>
</ReqRef><Comment>Handles reception of report parameters received with MA with shifted location reference.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Report parameters received"
 Guid="a072a522-be55-470d-ac59-e4904cf1245c"
>
<ReqRef
 Id="8e46d1f9-ece2-43e9-9a45-e2978111a3dc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fbc7c1b8-fb9d-4785-b3a8-b910c732edb4"
>
</ReqRef><PreConditions>
<PreCondition
 Guid="5b8975b0-260d-4631-8a07-a597c7067649"
>THERE_IS_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.POSITION_REPORT_PARAMETERS )</PreCondition><PreCondition
 Guid="29c7550e-0318-4ea1-be60-556bb6f76b25"
>aMessage.GENERAL_MESSAGE == EMPTY</PreCondition></PreConditions>
<Actions>
<Action
 Guid="d4dd1adc-2417-418e-9af1-28d490582186"
>PositionReport.UpdatePositionReportParameters
(
   ( FIRST_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1  | Available ( X.POSITION_REPORT_PARAMETERS ) ).POSITION_REPORT_PARAMETERS
)</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="d1763cf0-854a-43b9-890b-65362093d1e5"
>
<ReqRef
 Id="3eae43ab-6f26-4908-9360-5a8ce0bec069"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2551bc7c-0bcd-40d7-97b3-da8a51f1f3eb"
>
</ReqRef><Comment>Handles reception of the route suitability data received with MA with shifted location reference.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="05c6c904-72ce-4e9f-b546-00d44c02eb79"
>
<PreConditions>
<PreCondition
 Guid="785ad9f3-d16d-4ca7-a789-7e6ec4432c28"
>THERE_IS_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1 | Available ( X.ROUTE_SUITABILITY_DATA )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="249aeb3c-974b-4193-96c5-9a76aafc8946"
>Kernel.TrackDescription.RouteSuitability.RouteSuitabilityReceived ( Packet =&gt; ( FIRST_IN aMessage.MA_WITH_SHIFTED_LOCATION_REFERENCE.Sequence1  | Available ( X.ROUTE_SUITABILITY_DATA ) ).ROUTE_SUITABILITY_DATA )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Session management received"
 Guid="06578948-29db-4a5a-9791-be18d6e3069e"
>
<ReqRef
 Id="18318a83-420a-41a7-b3eb-e4e67f1e3f97"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4ad0147f-15d4-4238-8de0-2ececa983061"
>
</ReqRef><ReqRef
 Id="ff45f18e-7a7b-412e-8847-569b6605d632"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="95d9a572-5238-4503-a82c-fe8c0775545b"
>
</ReqRef><Comment>Handles reception of session management received with the MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Session management received"
 Guid="705b0473-0854-424b-b540-bd89e9a8fd20"
>
<PreConditions>
<PreCondition
 Guid="64594881-f511-44f7-b03e-67a2c19c357e"
>THERE_IS_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="7a4b291e-cb8d-40bf-9dc9-423cd269c364"
>TracksideOrderedSessionReceived ( Packet =&gt; ( FIRST_IN aMessage.MOVEMENT_AUTHORITY.Sequence1 | Available ( X.SESSION_MANAGEMENT )).SESSION_MANAGEMENT )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="UpdateINTERNAL"
 Implemented="TRUE"
 Name="Infill MA"
 Guid="ed471ca1-d692-4236-a58c-bfb34482b2b2"
>
<ReqRef
 Id="f4723221-15fd-4636-851f-08a437cc18e6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ffd8fa69-6a8a-4a28-b335-5593a40ea323"
>
</ReqRef><ReqRef
 Id="4a580e9d-fd64-4951-b7a4-51530d1469e7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d6de3548-9a65-4ada-a1ea-64a1c5951ce6"
>
</ReqRef><ReqRef
 Id="eca6c9fc-15bb-4b61-8142-88af3b8e685f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="83a5a26a-12f1-455a-9292-86eb8210ba4e"
>
</ReqRef><ReqRef
 Id="ecaefeed-fa89-4186-b8b7-e63999df3603"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fa7cb1f2-644d-4672-b24d-350205f7137f"
>
</ReqRef><ReqRef
 Id="6e740969-1d8d-40d5-bcaf-7bf18e08aa4b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="59aa4caf-5770-4786-9d48-e880bbbf674a"
>
</ReqRef><Comment>Handles reception of the infill MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="Infill MA"
 Guid="d88ca5bb-9db1-4adf-b76e-e87731cb14a6"
>
<PreConditions>
<PreCondition
 Guid="2218137b-5a46-48c7-996e-77239bd0276d"
>Available ( aMessage.INFILL_MA )</PreCondition><PreCondition
 Guid="ef9e6dde-adf6-4d12-a2ca-7091646da7e6"
>NOT (THERE_IS_IN Kernel.EmergencyStops | X.Reason == Kernel.BrakeReason.OrderFromRBC)</PreCondition></PreConditions>
<Actions>
</Actions>
<SubRules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="1cfcd676-857b-4365-ae5e-e92d658219b7"
>
<ReqRef
 Id="3eae43ab-6f26-4908-9360-5a8ce0bec069"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1aa70151-07e5-4921-beff-f097d27213fd"
>
</ReqRef><Comment>Handles reception of the route suitability data received with infill MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Route suitability data received"
 Guid="cfe0f284-c660-462a-b15f-f16501bcb05d"
>
<PreConditions>
<PreCondition
 Guid="a9a94a8a-24a1-42dd-bba4-78709ada8176"
>THERE_IS_IN aMessage.INFILL_MA.Sequence1 | Available ( X.ROUTE_SUITABILITY_DATA )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="7cd439db-30ed-4037-bc40-1110364e540b"
>Kernel.TrackDescription.RouteSuitability.RouteSuitabilityReceived ( Packet =&gt; ( FIRST_IN aMessage.INFILL_MA.Sequence1  | Available ( X.ROUTE_SUITABILITY_DATA ) ).ROUTE_SUITABILITY_DATA )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="ba5e7903-74f0-416c-ace9-cdc1392a7a73"
>
<ReqRef
 Id="de18f207-08ba-467b-a877-d3c5a458123d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="890d979e-b69a-40ed-9fb9-9575e833679d"
>
</ReqRef><Comment>Handles reception of mode profile received with the infill MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Mode profile received"
 Guid="5723e1bb-1530-43ae-b94a-8989fd2a71a0"
>
<PreConditions>
<PreCondition
 Guid="568a6d32-c46c-450a-86ed-fa1646521c57"
>THERE_IS_IN aMessage.INFILL_MA.Sequence1 | Available ( X.MODE_PROFILE )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="3913ccf6-bc3b-423b-a4da-7742b09c8e22"
>Kernel.MA.ModeProfile.ModeProfileReceived ( Packet =&gt; ( FIRST_IN aMessage.INFILL_MA.Sequence1 | Available ( X.MODE_PROFILE)).MODE_PROFILE )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="1e3c7c24-198c-43ed-975b-dbe5a441caf3"
>
<ReqRef
 Id="7e7c641f-fe52-42ac-9aa8-12e5c7dfd6b2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c6272465-206f-4fd5-958d-983191281a02"
>
</ReqRef><Comment>Handles reception of level transition orders received with the infill MA.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Level transition order received"
 Guid="b23111b6-dc5d-4ef3-bcdc-8872f1653ec4"
>
<PreConditions>
<PreCondition
 Guid="8eba5cd9-0030-4d92-826b-c91887c836ed"
>THERE_IS_IN aMessage.INFILL_MA.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="fd9f395f-4d3f-45ad-b8bf-3444ca9d3d17"
>Kernel.LevelTransition.LTOReceived ( Packet =&gt; ( FIRST_IN aMessage.INFILL_MA.Sequence1 | Available ( X.LEVEL_TRANSITION_ORDER )).LEVEL_TRANSITION_ORDER )</Action></Actions>
</RuleCondition></Conditions>
</Rule></SubRules>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="RBC/RIU system version"
 Guid="72ea757d-52ec-42fa-bd6a-154f694dc4ae"
>
<ReqRef
 Id="02f20f26-3445-49b9-95cf-a6948ab029b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bb6b5b48-be53-43e2-9e0c-154d5613bdd7"
>
</ReqRef><ReqRef
 Id="71740f57-d219-41b2-93f8-319c302b1afa"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="11c4849e-4311-4b6f-b7eb-f58c203eb04c"
>
</ReqRef><Comment>Handles reception of the RBC/RIU system version.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="RBC/RIU system version"
 Guid="17ca29cb-fad8-4162-8eb4-95e27de49f9d"
>
<PreConditions>
<PreCondition
 Guid="4fa84a57-6d47-40db-a5af-2a05d082f8c1"
>Available ( aMessage.RIU_SYSTEM_VERSION )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="edc7241a-b3a2-422c-bbe6-f815e0c132da"
>HandleRBCRIUSystemVersion ( aMessage =&gt; aMessage.RIU_SYSTEM_VERSION )</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="HandleRBCRIUSystemVersion"
 Guid="10dc8bf3-fb79-4fc2-987d-1b29ba45fa25"
>
<ReqRef
 Id="02f20f26-3445-49b9-95cf-a6948ab029b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ca11414d-dcc4-4bd5-992b-5a6a7c591964"
>
</ReqRef><Comment>When the RBC/RIU system version is received, it is stored on-board and will be used to indicate that the RBC connection is established.</Comment>
<Parameters>
<Parameter
 Type="Messages.MESSAGE.TRACK_TO_TRAIN.RBC.RIU_SYSTEM_VERSION.Message"
 Name="aMessage"
 Guid="ae749290-5bd3-4a59-8892-1f02e400373a"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Store the received system version"
 Guid="fb46a7fe-c199-4921-811e-cdacaa581017"
>
<Comment>Stores the received system version.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Store the received system version"
 Guid="b5198c94-238e-49b1-ab0f-a07e1f53f92d"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="e17bef78-a2ff-421f-8ab3-bf8d2d0939ac"
>CurrentRBCConnection().SessionManagementData.SystemVersion.Value &lt;- ConvertSystemVersion ( aVersion =&gt; aMessage.M_VERSION )</Action><Action
 Guid="8212c19a-2428-4a44-aa05-ed206845382b"
>CurrentRBCConnection().SessionManagementData.SystemVersion.DataState &lt;- DataState.Valid</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="HandleAcknowledgementOfTerminationOfACommunicationSession"
 Guid="02f670d2-b6dc-4079-80e8-8a75a9da20bc"
>
<ReqRef
 Id="e094e23a-bd94-4440-8632-705782494f35"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7f014caa-eade-494b-9fcd-4a5adf0777d8"
>
</ReqRef><Comment>Indicates that the acknowledgement has been received.</Comment>
<Parameters>
<Parameter
 Type="Messages.MESSAGE.TRACK_TO_TRAIN.ACKNOWLEDGEMENT_OF_TERMINATION_OF_A_COMMUNICATION_SESSION.Message"
 Name="aMessage"
 Guid="5cd96caa-1ee6-45dc-8552-8ef78ae617ef"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Indicate acknowledgement has been received"
 Guid="7f048ded-c30c-4e8a-8802-a96f2cadca26"
>
<Comment>Indicates that the acknowledgement has been received.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Indicate acknowledgement has been received"
 Guid="80443d2e-265f-4f6e-b114-a68aeca1f97b"
>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="7073da78-58f0-4a39-ae89-49ca19eb62dd"
>CurrentRBCConnection().SessionManagementData.AcknowledgementOfTerminationReceived &lt;- True</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure><Procedure
 Implemented="TRUE"
 Name="HandleEuroradioMessage"
 Guid="89a51dbf-4fc4-4d63-ba49-4fbbe790cd0b"
>
<ReqRef
 Id="e65c9779-618e-4a55-97c9-4038b3410eaf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3ce70874-1784-4303-8bc6-c9c2fa9bf503"
>
</ReqRef><Comment>Messages from RBC received after sending of Termination of communication session message will be ignored, with the exception of the acknowledgement.</Comment>
<Parameters>
<Parameter
 Type="Messages.MESSAGE.TRACK_TO_TRAIN.Message"
 Name="aMessage"
 Guid="a206901a-b071-4d83-a7f6-4a387cd26c24"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Verify connection state"
 Guid="793eda9e-a531-433c-94ef-be464ca63d25"
>
<ReqRef
 Id="e65c9779-618e-4a55-97c9-4038b3410eaf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="252fa286-33c9-43a3-a814-aebe342d6794"
>
</ReqRef><Comment>Messages from RBC received after sending of Termination of communication session message will be ignored, with the exception of the acknowledgement.

When Termination of communication session message is sent, the state machine goes to Terminating state, until the acknowledgement is received.

Thus, the ignore condition will be &quot;state machine is not in Terminating state&quot;.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Verify connection state"
 Guid="349a4108-82e2-4fc6-933a-e986b67dae1b"
>
<PreConditions>
<PreCondition
 Guid="e865f160-465a-4fa6-bbdf-5c4aa595c910"
>CurrentRBCConnection().ConnectionState not in RBCStruct.ConnectionStateSM.Connecting</PreCondition></PreConditions>
<Actions>
<Action
 Guid="7ffe8131-5392-4ec9-a32e-1ad7d3cb2dcd"
>ProcessIncomingMessages ( aMessage )</Action></Actions>
</RuleCondition></Conditions>
</Rule><Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Acknowledgement of termination of a communication session"
 Guid="9bface2c-454d-4b33-b511-aeffb5d3e5a5"
>
<ReqRef
 Id="6091731d-92bd-4133-aff2-790f6f482dbf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b81287cc-61be-4da1-829c-f7f8e04a9267"
>
</ReqRef><ReqRef
 Id="e094e23a-bd94-4440-8632-705782494f35"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fc5deb20-6eb3-4d7f-8a5c-523befd298e4"
>
</ReqRef><Comment>Handles reception of termination of a communication session.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Acknowledgement of termination of a communication session"
 Guid="313b2e1d-ce81-4e1e-bf2a-6f185ff186e5"
>
<PreConditions>
<PreCondition
 Guid="ced76e36-5c43-4286-9d04-213366e1c8a1"
>Available ( aMessage.ACKNOWLEDGEMENT_OF_TERMINATION_OF_A_COMMUNICATION_SESSION )</PreCondition></PreConditions>
<Actions>
<Action
 Guid="757ae52c-3581-4ad8-bd4d-bdc6a6dad180"
>HandleAcknowledgementOfTerminationOfACommunicationSession ( aMessage =&gt; aMessage.ACKNOWLEDGEMENT_OF_TERMINATION_OF_A_COMMUNICATION_SESSION )</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="Default.BaseTypes.Time"
 DefaultValue="15.0"
 VariableMode="Constant"
 Implemented="TRUE"
 Name="TimeBeforeMessageRepetition"
 Guid="7fb9905e-15ef-46c7-bd03-db851be58bc7"
>
<ReqRef
 Id="0f9b05dd-7dd5-408f-94d8-e94d2b283f7c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0415d335-0a90-4f02-8ec4-240662656ae8"
>
</ReqRef><Comment>Represents the waiting time before radio message repetition.</Comment>
</Variable><Variable
 Type="Integer"
 DefaultValue="3"
 VariableMode="Constant"
 Implemented="TRUE"
 Name="NumberOfMessageRepetitions"
 Guid="c6fc6f21-c004-4e60-9413-a82917e94238"
>
<ReqRef
 Id="023bb134-975d-4e3e-9294-8f3644763d4f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="430f28c3-f752-4247-93ae-fd580cbd55c8"
>
</ReqRef><Comment>Indicates the number of repetitions of radio messages (i.e. excluding the first sending).</Comment>
</Variable><Variable
 Type="RIUStruct"
 VariableMode="InOut"
 Implemented="TRUE"
 Name="RIU"
 Guid="65546b18-9082-469d-85f1-2f2a2c945818"
>
<ReqRef
 Id="64296fc8-fe88-499d-b63e-d570a4a39744"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0bfec18e-8a2f-4476-a678-ac8e9ed363cb"
>
</ReqRef><Comment>RIU connection.</Comment>
</Variable><Variable
 Type="RBCContactStruct"
 DefaultValue=""
 VariableMode="Internal"
 Implemented="TRUE"
 Name="LastKnownRBC"
 Guid="871247fa-7189-4f13-874e-e3466aad155e"
>
<ReqRef
 Id="369d7ae0-50db-411b-9941-bbe30e354733"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9e28c009-2f92-4859-8e59-109fe39db193"
>
</ReqRef><ReqRef
 Id="69dc4eed-7cae-45b6-adbb-58b2b1ac6edd"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b16379af-d5c7-4071-815c-245a173d6287"
>
</ReqRef><ReqRef
 Id="31fff3ff-41dc-41fb-9f2e-b43b04a91e5e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6d078814-362d-4fc3-8fe8-9c5a20662f9d"
>
</ReqRef><Comment>Contains information about the last known RBC.</Comment>
</Variable><Variable
 Type="String"
 DefaultValue="&apos;&apos;"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="ShortNumber"
 Guid="56e3a8ca-da3a-43e8-b3a9-ba7a9a8a6805"
>
<ReqRef
 Id="1563df47-a941-45f8-9388-142278ad7952"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a26a7788-a37b-40ae-8235-4e3f28870b7d"
>
</ReqRef><ReqRef
 Id="f8152593-9f99-41a4-9ae8-b51e619e6ece"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="821540b1-66cb-486b-918d-6cdd79e1c6f9"
>
</ReqRef><ReqRef
 Id="40859515-77c4-46aa-96a5-12453cd171a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35afd293-b8b4-4acb-9b06-f5ae19225f06"
>
</ReqRef><Comment>The short number of the RBC.</Comment>
</Variable><Variable
 Type="String"
 DefaultValue="&apos;&apos;"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="LastKnownNetworkId"
 Guid="4c27382c-64a2-4c88-8d58-ff66b400ad51"
>
<ReqRef
 Id="9bf96521-7fd6-4183-ab61-1276d48d3996"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e601cf1c-a807-4f9a-a762-522cf4cf6d78"
>
</ReqRef><Comment>The last received Radio Network identity.</Comment>
</Variable><Variable
 Type="AvailableNetworksStruct"
 DefaultValue=""
 VariableMode="InOut"
 Implemented="TRUE"
 Name="AvailableNetworks"
 Guid="f24775ac-92d1-48d2-8446-fcd2eb8c7467"
>
<ReqRef
 Id="88987d99-35ff-4f33-894e-06060476dc7d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="69752379-7c7f-4176-a31b-b10e08129209"
>
</ReqRef><Comment>Allows to request the list of available and allowed networks.</Comment>
</Variable><Variable
 Type="MobileTerminalStruct"
 VariableMode="InOut"
 Implemented="TRUE"
 Name="Terminal1"
 Guid="b9169f5f-b1a9-481e-8d17-7b9aee24c60e"
>
<ReqRef
 Id="865bbdd6-2010-4869-ab3e-bc538ce5fe4b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="94da1534-d4e2-409f-94e9-6c7efcd8d7b5"
>
</ReqRef><Comment>First terminal struct.</Comment>
</Variable><Variable
 Type="MobileTerminalStruct"
 VariableMode="InOut"
 Implemented="TRUE"
 Name="Terminal2"
 Guid="14bc979c-299e-41a1-b18b-77e58ca89e59"
>
<ReqRef
 Id="865bbdd6-2010-4869-ab3e-bc538ce5fe4b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6e9b5735-16ad-4ad3-89ff-7df9a6f5141b"
>
</ReqRef><Comment>Second mobile terminal.</Comment>
</Variable><Variable
 Type="ContactOptionEnum"
 DefaultValue="ContactOptionEnum.ContactLastKnownRBC"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="ContactOption"
 Guid="81db5f5d-dec8-43d9-9546-57479127847f"
>
<ReqRef
 Id="369d7ae0-50db-411b-9941-bbe30e354733"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="89bfb0f7-0fbc-463d-8559-90146c0c036a"
>
</ReqRef><ReqRef
 Id="40859515-77c4-46aa-96a5-12453cd171a2"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d790ef37-059b-46c9-98d4-26e098675485"
>
</ReqRef><ReqRef
 Id="cebfc056-7b96-49d7-a6ff-1fdf0076bb9e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2a4a5158-6dd4-4d58-a1ac-ed6953f88826"
>
</ReqRef><Comment>Indicates how the RBC has to be contacted.</Comment>
</Variable><Variable
 Type="String"
 DefaultValue="&apos;&apos;"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="DefaultRadioNetworkId"
 Guid="2899d0b5-6c7a-4333-b3c0-d5226c93ec7e"
>
<ReqRef
 Id="5e068e1e-2be5-45b6-b9eb-d1151df93748"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="8b46767d-0979-4a7a-9437-5ca9d5f363ac"
>
</ReqRef><ReqRef
 Id="5e068e1e-2be5-45b6-b9eb-d1151df93748"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="aa7dc0c0-dce3-4fb0-9217-e463d4e2fc72"
>
</ReqRef><Comment>Gives the values of the default radio network, to be used when no Radio Network identity was received from trackside or from driver.</Comment>
</Variable><Variable
 Type="SystemVersionsCol"
 DefaultValue="[SystemVersionEnum.Version2_0]"
 VariableMode="Internal"
 Implemented="TRUE"
 Name="SupportedSystemVersions"
 Guid="e9003f47-af6c-4289-a33b-60b830bf4ccc"
>
<ReqRef
 Id="790cf49e-a85c-4110-b567-fc5d57052339"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2acdb939-507a-4b5f-999c-19821626b9dd"
>
</ReqRef><ReqRef
 Id="25af834a-3a24-459b-b5c8-97b85eddb2e8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e3520cf1-6680-45fb-adc6-d49129321b6d"
>
</ReqRef><Comment>System versions supported by the on-board.</Comment>
</Variable></Variables>
</NameSpace>
