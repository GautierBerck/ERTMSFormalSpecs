<NameSpace
 X="1110"
 Y="830"
 Width="100"
 Height="50"
 Name="LimitedSupervision"
 Guid="cdb147cf-96f4-4e75-af93-fcc12553245f"
>
<NameSpaces>
</NameSpaces>
<Functions>
<Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="20"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMA"
 Guid="928abe4d-839f-461f-9e89-b7dfa7b45cf3"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a4dc568-aa7d-4f07-ad2a-4d469d80cd3d"
>
</ReqRef><ReqRef
 Id="7ff97a9b-f10c-4e4c-b174-b68c9f680b6e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2b5df077-f19a-4e3a-b038-3865bdfe5214"
>
</ReqRef><ReqRef
 Id="37c50c6b-4e41-4db0-ad87-b7b3d074bc00"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fb8eb045-43a8-4078-bda0-11b06e7dd894"
>
</ReqRef><Comment>Provides the Lowest Supervised Speed within the Movement Authority for display on the DMI.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="a795b238-b08a-466f-9212-549c49ace202"
>
<Expression>REDUCE SpeedAndDistanceMonitoring.TargetsList() | X.Location &lt;= MA.ClosestEOA().Location
 USING X IN BaseTypes.MinSpeed(
    X1 =&gt; X.Speed,
    X2 =&gt; RESULT
    )
 INITIAL_VALUE BaseTypes.Speed.MaxSpeed</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="130"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ToggleLSSMA"
 Guid="0f8bb773-6f00-4ae4-9093-9325532e6525"
>
<ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e98a2962-ade8-41c1-ba4f-5054ace389d1"
>
</ReqRef><Comment>Tells whether the current stored LSSMA toggle order is applicable.</Comment>
<Parameters>
<Parameter
 Type="Default.DateAndTime"
 Name="Timer"
 Guid="75803895-6542-47e6-bda9-4ec61f8d7d33"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="cc783aba-e5bc-4cd8-9ad6-0fb1de83feb2"
>
<Expression>NOT DateAndTime.T1LaterThanT2(
    T1 =&gt; Timer,
    T2 =&gt; DateAndTime.Now()
)</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="350"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSMarkerPresent"
 Guid="80f48457-e268-4406-8dbe-b87ad27f3412"
>
<ReqRef
 Id="259b9778-4f75-4c5b-a658-9eef737938bf"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0358f21f-5b75-4090-b12a-6cb748d12333"
>
</ReqRef><Comment>Checks the Balise message for an applicable Generic LS Function Marker packet.</Comment>
<Parameters>
<Parameter
 Type="BTM.BaliseGroupMessages"
 Name="Messages"
 Guid="e2df65a0-1bff-41c8-88b3-77a0ec29cf8f"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="138c3e29-2865-4d85-9949-628b35db01f7"
>
<Expression>THERE_IS Message IN Messages | 
(
  THERE_IS Packet IN Message.Telegram.Sequence1 |
    BTM.ConsiderPacket(Packet.TRACK_TO_TRAIN.GENERIC_LS_FUNCTION_MARKER.Q_DIR)
)</Expression>
</Case></Cases>
</Function><Function
 Type="Boolean"
 Default=""
 X="240"
 Y="160"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Verified="TRUE"
 Name="DisplayLSSMA_NoMarker"
 Guid="7adeb371-786c-421d-8701-762364d1637a"
>
<ReqRef
 Id="b54058d6-eecd-40ca-883f-f77c6bf457b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6bcab6eb-bf62-4c30-b43a-be2f7b8d3325"
>
</ReqRef><ReqRef
 Id="2b70094d-4b34-482b-8e02-5076957231fb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7db3c6fe-522a-4627-8f74-6d6b09e5e4b8"
>
</ReqRef><ReqRef
 Id="2378ec5b-b103-4415-b159-4c016a0c0966"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a7c7c2b3-0478-4174-bac3-54dc3d597d84"
>
</ReqRef><Comment>Determines whether the LSSMA should be displayed on the DMI in the case where there is no Generic LS Function Marker stored on-board.</Comment>
<Cases>
<Case
 Name="Value"
 Guid="b1841b01-71d6-438a-a2c7-f9ce2f3d0015"
>
<Expression>MA.MA.TargetSpeed &lt; ModeRelatedSpeedLimits.LSModeSpeedLimit()
  AND  
LSSMA() &lt; TrainData.TrainData.Value.MaximumSpeed</Expression>
</Case></Cases>
</Function></Functions>
<Procedures>
<Procedure
 X="20"
 Y="250"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMAToggleReceived"
 Guid="22c1b21a-75b1-4006-8452-ba171f6ab645"
>
<ReqRef
 Id="569567b3-3681-4d80-9bed-9a1376f4cd6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e4704ab4-9bff-4b47-b832-3cdc8d8c25f1"
>
</ReqRef><ReqRef
 Id="5ab8592b-d34d-449a-b9b4-a49404c758ed"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="74832289-a479-4ea9-83db-6848482a1203"
>
</ReqRef><ReqRef
 Id="fa830e21-7694-4e0e-b5e1-ec5a23036c07"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="45d00f7a-de3e-406d-8d6d-fac30020c753"
>
</ReqRef><ReqRef
 Id="18659e26-db48-44a9-99f6-e2b9335a9581"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="35107d02-9267-4c90-a4ff-c1660bfc1478"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2fc9da03-c005-451f-9179-7cedce159527"
>
</ReqRef><ReqRef
 Id="7a1c72d6-e564-40a5-ac23-c5e4926af96f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="e96835fd-f4ce-4763-bc05-6848f60393de"
>
</ReqRef><ReqRef
 Id="cb1268f7-53cb-49c8-a6d9-4e4b32f7774f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3152d1d5-006f-4683-abbd-708a98c9d10f"
>
</ReqRef><Comment>Handles the reception of a LSSMA TOGGLE ORDER packet received from trackside.</Comment>
<Parameters>
<Parameter
 Type="Messages.PACKET.TRACK_TO_TRAIN.LSSMA_DISPLAY_TOGGLE_ORDER.Message"
 Name="Packet"
 Guid="87e8069d-2228-45f8-9cdf-3ac6399ec97b"
>
</Parameter><Parameter
 Type="Default.DateAndTime"
 Name="Timestamp"
 Guid="c4071851-c23c-4987-8f79-87eab60bcbf5"
>
</Parameter></Parameters>
<Rules>
<Rule
 Priority="Processing"
 Implemented="TRUE"
 Name="Handle packet"
 Guid="df0ee044-583d-4d3d-9cd1-75bf08985ee9"
>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="Toggle off"
 Guid="34d018bc-1420-4995-b12f-a9518c2ac1bc"
>
<ReqRef
 Id="8875844d-6767-46d6-81e6-f515e52f4417"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fe28c2bd-641a-469f-a823-498818601b56"
>
</ReqRef><Comment>Received order to toggle LSSMA display off.</Comment>
<PreConditions>
<PreCondition
 Guid="9f5c5229-f103-4bc9-8913-b0de22327985"
>Packet.Q_LSSMA == Messages.Q_LSSMA.Toggle_off</PreCondition></PreConditions>
<Actions>
<Action
 Guid="bbd8de6f-c017-4c43-8813-479a83feb5ca"
>DisplayLSSMA &lt;- False</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Toggle on"
 Guid="8d6eea67-f152-45e6-a781-dd0de24bbd60"
>
<Comment>Received order to toggle LSSMA display on.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="e6cbc16f-e753-4b29-b052-f2401dfd0902"
>LSSMATimer &lt;- AddToDate(
    StartDate=&gt;Timestamp,
    Increment=&gt;MessageTypes.TimeResolution(Packet.T_LSSMA)
)</Action><Action
 Guid="6e0544aa-f885-4470-baef-cd7ed7c95aa3"
>DisplayLSSMA &lt;- True</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</Procedure></Procedures>
<Variables>
<Variable
 Type="Boolean"
 DefaultValue="False"
 VariableMode="Internal"
 X="160"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="DisplayLSSMA"
 Guid="e288e932-4856-4e56-8601-01a602e8dc33"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3037d040-75ae-4329-b2e8-5af66abc1a94"
>
</ReqRef><ReqRef
 Id="7a1c72d6-e564-40a5-ac23-c5e4926af96f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d6ed695f-e6cb-4a14-b2e8-6a3d95b7172c"
>
</ReqRef><Comment>Indicates whether the display of the LSSMA has been requested by trackside.</Comment>
</Variable><Variable
 Type="Default.DateAndTime"
 DefaultValue=""
 VariableMode="Internal"
 X="380"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LSSMATimer"
 Guid="2106ccd6-7457-45ef-8768-a84abd3e73db"
>
<ReqRef
 Id="569567b3-3681-4d80-9bed-9a1376f4cd6f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="023085e6-f53f-43f6-bde1-910ae6d45a77"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a25512c-51fb-4d04-9344-f4cdd1069b7f"
>
</ReqRef></Variable><Variable
 Type="Boolean"
 DefaultValue="False"
 VariableMode="Internal"
 X="270"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="GenericMarkerStored"
 Guid="69ca29b8-9d78-4906-abb2-1854361786c0"
>
<ReqRef
 Id="b54058d6-eecd-40ca-883f-f77c6bf457b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="168780a7-2304-45e5-88e6-6efebb5d6ef4"
>
</ReqRef><Comment>Indicates whether the generic LS function marker is stored on-board.</Comment>
</Variable></Variables>
<Rules>
<Rule
 Priority="Processing"
 X="10"
 Y="20"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="Display the LSSMA"
 Guid="c19d2a38-784e-453c-8139-b9f20a07f63b"
>
<ReqRef
 Id="e3caa999-1864-4f55-998d-66166d0a163b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="68938b74-d468-4b2b-be79-72a949d1fcc5"
>
</ReqRef><ReqRef
 Id="a2ec7ec3-6644-47d6-8ee1-9e4b16650cc3"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1c6e67f9-6b37-42aa-872c-ae4b0fc27d44"
>
</ReqRef><ReqRef
 Id="cc5dadda-f34e-4f97-a9b7-e5e5b8f9e82f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="95f59151-c37d-4b9f-8c97-3e793496537a"
>
</ReqRef><ReqRef
 Id="cb1268f7-53cb-49c8-a6d9-4e4b32f7774f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7f9cbb8a-ddfa-47cb-9d1d-c4d3ed25bd77"
>
</ReqRef><ReqRef
 Id="8875844d-6767-46d6-81e6-f515e52f4417"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="0963b82d-ae07-45c4-b9db-5f58d2d4913f"
>
</ReqRef><ReqRef
 Id="b54058d6-eecd-40ca-883f-f77c6bf457b1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4e0e8dc3-05a1-47c5-997b-e6e61e01db21"
>
</ReqRef><Comment>Handles the display of the LSSMA on the DMI.</Comment>
<SubRules></SubRules>
<Conditions>
<RuleCondition
 Implemented="TRUE"
 Name="No generic marker stored"
 Guid="6b209df1-5453-4c89-8677-dbfa2e80a560"
>
<Comment>The case where LS mode has been entered without a Generic LS Function Marker being sent from trackside.</Comment>
<PreConditions>
<PreCondition
 Guid="785dc39d-f576-4174-a72b-79329f059799"
>Mode == Default.Mode.LS</PreCondition><PreCondition
 Guid="89715f06-cfc4-4f73-8971-ed53219333bb"
>NOT GenericMarkerStored</PreCondition></PreConditions>
<Actions>
</Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Display"
 Guid="42953bf4-a86b-49b3-a1d4-5108ec72d3f9"
>
<Comment>Display if the mode is LS and LSSMA display was requested.</Comment>
<PreConditions>
<PreCondition
 Guid="e9df8f11-12e4-41a7-973e-1176052b5b06"
>Mode == Default.Mode.LS</PreCondition><PreCondition
 Guid="fc268b32-269a-4b5f-8bd5-8cc11d0af92f"
>DisplayLSSMA</PreCondition><PreCondition
 Guid="51faf229-83b8-4750-ac65-bd38c3665763"
>ToggleLSSMA(LSSMATimer)</PreCondition></PreConditions>
<Actions>
<Action
 Guid="f0bbc56b-5ce9-4ed9-b894-5a9aeb142ae1"
>DMI.MasterDMI().Out_LSSMA.Display()</Action></Actions>
</RuleCondition><RuleCondition
 Implemented="TRUE"
 Name="Hide"
 Guid="ed087f28-8a55-4991-b6cc-49999f1ea592"
>
<Comment>Hide in other circumstances.</Comment>
<PreConditions>
</PreConditions>
<Actions>
<Action
 Guid="0d503784-869b-441b-b8d0-acd55aec8f7c"
>DMI.MasterDMI().Out_LSSMA.OutputInformation.DoNotDisplay()</Action></Actions>
</RuleCondition></Conditions>
</Rule></Rules>
</NameSpace>
