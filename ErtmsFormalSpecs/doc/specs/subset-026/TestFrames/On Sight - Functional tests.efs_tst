<Frame
 CycleDuration="0.1"
 Name="On Sight - Functional tests"
>
<SubSequences>
<SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="Acknowledgement"
>
<TestCases>
<TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 Name="Ack request displayed"
>
<ReqRef
 Id="5.9.2.4"
>
</ReqRef>
<ReqRef
 Id="5.9.2.7"
>
</ReqRef>
<Comment>If the OBU change the mode to OS a request of Acknowlegement shall be displayed to the driver. In order to do this, the OBU shall be in S25. </Comment>
<Steps>
<Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step1 - Setup"
>
<SubSteps>
<SubStep
 Name="Sub-step1"
>
<Actions>
<Action>Kernel.InitializeTestEnvironment()</Action>
</Actions>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step2 - Mode OS + Display requested"
>
<SubSteps>
<SubStep
 Name="SubStep1"
>
<Actions>
<Action>BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;1,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [ 
       
 Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                 LEVEL_1_MOVEMENT_AUTHORITY=&gt;Messages.PACKET.TRACK_TO_TRAIN.LEVEL_1_MOVEMENT_AUTHORITY.Message
                {
                    NID_PACKET=&gt;12,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    V_MAIN=&gt;16,
                    V_LOA=&gt;8,
                    T_LOA=&gt;200,
                    N_ITER=&gt;0,
                    Sequence1=&gt;[],
                    L_ENDSECTION=&gt;1000,
                    Q_SECTIONTIMER=&gt;Messages.Q_SECTIONTIMER.No_Section_Timer_information,
                    T_SECTIONTIMER=&gt;0,
                    D_SECTIONTIMERSTOPLOC=&gt;0,
                    Q_ENDTIMER=&gt;Messages.Q_ENDTIMER.No_End_section_timer_information,
                    T_ENDTIMER=&gt;0,
                    D_ENDTIMERSTARTLOC=&gt;0,
                    Q_DANGERPOINT=&gt;Messages.Q_DANGERPOINT.Danger_point_information_to_follow,
                    D_DP=&gt;12000,
                    V_RELEASEDP=&gt;5,
                    Q_OVERLAP=&gt;Messages.Q_OVERLAP.No_overlap_information,
                    D_STARTOL=&gt;0,
                    T_OL=&gt;0,
                    D_OL=&gt;0,
                    V_RELEASEOL=&gt;0
                }
            }
         },
Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                MODE_PROFILE=&gt;Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message
                {
                   D_MAMODE=&gt;0,
                   L_ACKMAMODE=&gt;500,
                   L_MAMODE=&gt;100,
                   L_PACKET=&gt;0,
                   M_MAMODE=&gt;Messages.M_MAMODE.On_Sight,               
                   N_ITER=&gt;0,
                   NID_PACKET=&gt;80,
                   Q_DIR=&gt; Messages.Q_DIR.Nominal,
                   Q_MAMODE=&gt; Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA,
                   Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                   V_MAMODE=&gt;1,
                   Sequence1=&gt;[] 
                }
           }
               }
                           ]
}</Action>
<Action>Kernel.HandleModeChange &lt;- Kernel.HandleModeChange.StartOfMission.S25</Action>
</Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
>DMI.MasterDMI().In_AcknOfOSMode.InputInformation.DisplayRequested == Boolean.True</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
>Kernel.MA.ModeProfile.CurrentMode() == Default.Mode.ModeProfile.OS</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 TranslationRequired="FALSE"
 Name="Step3 - New OS mode + No more request"
>
<Comment>If the OBU is already in OS when receiving a new one, no more requirement needed. </Comment>
<SubSteps>
<SubStep
 Name="SubStep1"
>
<Actions>
<Action>Kernel.Mode &lt;- Default.Mode.OS</Action>
</Actions>
</SubStep><SubStep
 Name="Sub-step2"
>
<Actions>
<Action>BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;1,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [ 
       
 Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                 LEVEL_1_MOVEMENT_AUTHORITY=&gt;Messages.PACKET.TRACK_TO_TRAIN.LEVEL_1_MOVEMENT_AUTHORITY.Message
                {
                    NID_PACKET=&gt;12,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    V_MAIN=&gt;16,
                    V_LOA=&gt;8,
                    T_LOA=&gt;200,
                    N_ITER=&gt;0,
                    Sequence1=&gt;[],
                    L_ENDSECTION=&gt;1000,
                    Q_SECTIONTIMER=&gt;Messages.Q_SECTIONTIMER.No_Section_Timer_information,
                    T_SECTIONTIMER=&gt;0,
                    D_SECTIONTIMERSTOPLOC=&gt;0,
                    Q_ENDTIMER=&gt;Messages.Q_ENDTIMER.No_End_section_timer_information,
                    T_ENDTIMER=&gt;0,
                    D_ENDTIMERSTARTLOC=&gt;0,
                    Q_DANGERPOINT=&gt;Messages.Q_DANGERPOINT.Danger_point_information_to_follow,
                    D_DP=&gt;12000,
                    V_RELEASEDP=&gt;5,
                    Q_OVERLAP=&gt;Messages.Q_OVERLAP.No_overlap_information,
                    D_STARTOL=&gt;0,
                    T_OL=&gt;0,
                    D_OL=&gt;0,
                    V_RELEASEOL=&gt;0
                }
            }
         },
Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                MODE_PROFILE=&gt;Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message
                {
                   D_MAMODE=&gt;50,
                   L_ACKMAMODE=&gt;500,
                   L_MAMODE=&gt;150,
                   L_PACKET=&gt;0,
                   M_MAMODE=&gt;Messages.M_MAMODE.On_Sight,               
                   N_ITER=&gt;0,
                   NID_PACKET=&gt;80,
                   Q_DIR=&gt; Messages.Q_DIR.Nominal,
                   Q_MAMODE=&gt; Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA,
                   Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                   V_MAMODE=&gt;1,
                   Sequence1=&gt;[] 
                }
           }
               }
                           ]
}</Action>
</Actions>
<Expectations>
<Expectation
 DeadLine="1"
>DMI.MasterDMI().In_AcknOfOSMode.InputInformation.DisplayRequested == Boolean.False</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence><SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="On Sight Mode Profile"
>
<TestCases>
<TestCase
 Feature="0"
 Case="0"
 Implemented="TRUE"
 Name="OS Mode Profile received"
>
<ReqRef
 Id="5.9.2.1"
>
</ReqRef>
<ReqRef
 Id="5.9.1.1"
>
</ReqRef>
<Steps>
<Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step1 - Setup"
>
<SubSteps>
<SubStep
 Name="Sub-step1"
>
<Actions>
<Action>Kernel.InitializeTestEnvironment()</Action>
</Actions>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Mode SR + Level 1"
>
<Comment>Actions needed for enter OS mode</Comment>
<SubSteps>
<SubStep
 Name="Sub-step1"
>
<Actions>
<Action>Kernel.Level.DataState &lt;- Default.DataState.Valid</Action>
<Action>Kernel.Level.Value &lt;- Default.Level.L1</Action>
<Action>Kernel.Mode &lt;- Default.Mode.SR</Action>
</Actions>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step3 - BTM.Message ModeProfile OS + Train far from OS Mode area"
>
<Comment>Train position before entering the OS mode area by far, so OBU should not be in OS mode</Comment>
<SubSteps>
<SubStep
 Name="Sub-step1"
>
<Actions>
<Action>BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;1,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [ 
       
 Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                 LEVEL_1_MOVEMENT_AUTHORITY=&gt;Messages.PACKET.TRACK_TO_TRAIN.LEVEL_1_MOVEMENT_AUTHORITY.Message
                {
                    NID_PACKET=&gt;12,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    V_MAIN=&gt;16,
                    V_LOA=&gt;8,
                    T_LOA=&gt;200,
                    N_ITER=&gt;0,
                    Sequence1=&gt;[],
                    L_ENDSECTION=&gt;1000,
                    Q_SECTIONTIMER=&gt;Messages.Q_SECTIONTIMER.No_Section_Timer_information,
                    T_SECTIONTIMER=&gt;0,
                    D_SECTIONTIMERSTOPLOC=&gt;0,
                    Q_ENDTIMER=&gt;Messages.Q_ENDTIMER.No_End_section_timer_information,
                    T_ENDTIMER=&gt;0,
                    D_ENDTIMERSTARTLOC=&gt;0,
                    Q_DANGERPOINT=&gt;Messages.Q_DANGERPOINT.Danger_point_information_to_follow,
                    D_DP=&gt;12000,
                    V_RELEASEDP=&gt;5,
                    Q_OVERLAP=&gt;Messages.Q_OVERLAP.No_overlap_information,
                    D_STARTOL=&gt;0,
                    T_OL=&gt;0,
                    D_OL=&gt;0,
                    V_RELEASEOL=&gt;0
                }
            }
         },
Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                MODE_PROFILE=&gt;Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message
                {
                   D_MAMODE=&gt;50,
                   L_ACKMAMODE=&gt;500,
                   L_MAMODE=&gt;100,
                   L_PACKET=&gt;0,
                   M_MAMODE=&gt;Messages.M_MAMODE.On_Sight,               
                   N_ITER=&gt;0,
                   NID_PACKET=&gt;80,
                   Q_DIR=&gt; Messages.Q_DIR.Nominal,
                   Q_MAMODE=&gt; Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA,
                   Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                   V_MAMODE=&gt;1,
                   Sequence1=&gt;[] 
                }
           }
               }
                           ]
}</Action>
<Action>Odometry.NominalDistance &lt;- 180.0</Action>
</Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
>Kernel.Mode != Default.Mode.OS</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step4 - BTM.Message ModeProfile OS + train near OS Mode area"
>
<Comment>Train position near the OS mode Area, so OBU shall be in OS mode</Comment>
<SubSteps>
<SubStep
 Name="SubStep1"
>
<Actions>
<Action>Odometry.NominalDistance &lt;- 190.0</Action>
<Action>BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;1,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [ 
       
 Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                 LEVEL_1_MOVEMENT_AUTHORITY=&gt;Messages.PACKET.TRACK_TO_TRAIN.LEVEL_1_MOVEMENT_AUTHORITY.Message
                {
                    NID_PACKET=&gt;12,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    V_MAIN=&gt;16,
                    V_LOA=&gt;8,
                    T_LOA=&gt;200,
                    N_ITER=&gt;0,
                    Sequence1=&gt;[],
                    L_ENDSECTION=&gt;1000,
                    Q_SECTIONTIMER=&gt;Messages.Q_SECTIONTIMER.No_Section_Timer_information,
                    T_SECTIONTIMER=&gt;0,
                    D_SECTIONTIMERSTOPLOC=&gt;0,
                    Q_ENDTIMER=&gt;Messages.Q_ENDTIMER.No_End_section_timer_information,
                    T_ENDTIMER=&gt;0,
                    D_ENDTIMERSTARTLOC=&gt;0,
                    Q_DANGERPOINT=&gt;Messages.Q_DANGERPOINT.Danger_point_information_to_follow,
                    D_DP=&gt;12000,
                    V_RELEASEDP=&gt;5,
                    Q_OVERLAP=&gt;Messages.Q_OVERLAP.No_overlap_information,
                    D_STARTOL=&gt;0,
                    T_OL=&gt;0,
                    D_OL=&gt;0,
                    V_RELEASEOL=&gt;0
                }
            }
         },
Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                MODE_PROFILE=&gt;Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message
                {
                   D_MAMODE=&gt;50,
                   L_ACKMAMODE=&gt;500,
                   L_MAMODE=&gt;100,
                   L_PACKET=&gt;0,
                   M_MAMODE=&gt;Messages.M_MAMODE.On_Sight,               
                   N_ITER=&gt;0,
                   NID_PACKET=&gt;80,
                   Q_DIR=&gt; Messages.Q_DIR.Nominal,
                   Q_MAMODE=&gt; Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA,
                   Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                   V_MAMODE=&gt;1,
                   Sequence1=&gt;[] 
                }
           }
               }
                           ]
}</Action>
</Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
>Kernel.Mode == Default.Mode.OS</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 TranslationRequired="FALSE"
 Name="Step5 - BTM.Message ModeProfile OS + OS mode area"
>
<Comment>Train in OS area, so OBU mode shall be OS mode</Comment>
<SubSteps>
<SubStep
 Name="SubStep1"
>
<Actions>
<Action>Odometry.NominalDistance &lt;- 200.0</Action>
<Action>BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN=&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION=&gt;1,
    Q_MEDIA=&gt;Messages.Q_MEDIA.Balise,
    N_PIG=&gt;0,
    N_TOTAL=&gt;0,
    M_DUP=&gt;Messages.M_DUP.No_duplicates,
    M_MCOUNT=&gt;4,
    NID_C=&gt;140,
    NID_BG=&gt;2124,
    Q_LINK=&gt;Messages.Q_LINK.Linked,
    Sequence1=&gt;
    [ 
       
 Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                 LEVEL_1_MOVEMENT_AUTHORITY=&gt;Messages.PACKET.TRACK_TO_TRAIN.LEVEL_1_MOVEMENT_AUTHORITY.Message
                {
                    NID_PACKET=&gt;12,
                    Q_DIR=&gt;Messages.Q_DIR.Nominal,
                    L_PACKET=&gt;400,
                    Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                    V_MAIN=&gt;16,
                    V_LOA=&gt;8,
                    T_LOA=&gt;200,
                    N_ITER=&gt;0,
                    Sequence1=&gt;[],
                    L_ENDSECTION=&gt;1000,
                    Q_SECTIONTIMER=&gt;Messages.Q_SECTIONTIMER.No_Section_Timer_information,
                    T_SECTIONTIMER=&gt;0,
                    D_SECTIONTIMERSTOPLOC=&gt;0,
                    Q_ENDTIMER=&gt;Messages.Q_ENDTIMER.No_End_section_timer_information,
                    T_ENDTIMER=&gt;0,
                    D_ENDTIMERSTARTLOC=&gt;0,
                    Q_DANGERPOINT=&gt;Messages.Q_DANGERPOINT.Danger_point_information_to_follow,
                    D_DP=&gt;12000,
                    V_RELEASEDP=&gt;5,
                    Q_OVERLAP=&gt;Messages.Q_OVERLAP.No_overlap_information,
                    D_STARTOL=&gt;0,
                    T_OL=&gt;0,
                    D_OL=&gt;0,
                    V_RELEASEOL=&gt;0
                }
            }
         },
Messages.EUROBALISE.SubStructure1
        {
            TRACK_TO_TRAIN=&gt;Messages.PACKET.TRACK_TO_TRAIN.Message
            {
                MODE_PROFILE=&gt;Messages.PACKET.TRACK_TO_TRAIN.MODE_PROFILE.Message
                {
                   D_MAMODE=&gt;50,
                   L_ACKMAMODE=&gt;500,
                   L_MAMODE=&gt;100,
                   L_PACKET=&gt;0,
                   M_MAMODE=&gt;Messages.M_MAMODE.On_Sight,               
                   N_ITER=&gt;0,
                   NID_PACKET=&gt;80,
                   Q_DIR=&gt; Messages.Q_DIR.Nominal,
                   Q_MAMODE=&gt; Messages.Q_MAMODE.as_both_the_EOA_and_SvL__instead_of_the_EOA_and_SvL_given_by_the_MA,
                   Q_SCALE=&gt;Messages.Q_SCALE._1_m_scaleC,
                   V_MAMODE=&gt;1,
                   Sequence1=&gt;[] 
                }
           }
               }
                           ]
}</Action>
</Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
>Kernel.Mode == Default.Mode.OS</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence></SubSequences>
</Frame>
